<!DOCTYPE html><html lang='en'><head><title>Sports Analytics</title><meta charset="utf-8"><style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}strong{font-weight:bolder}code{font-family:monospace,monospace;font-size:1em}img{border-style:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}blockquote,h1,h2,h3,h4,p,pre{margin:0}ol,ul{list-style:none;margin:0;padding:0}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e2e8f0}img{border-style:solid}table{border-collapse:collapse}h1,h2,h3,h4{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}code,pre{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}img{display:block;vertical-align:middle}img{max-width:100%;height:auto}.bg-gray-100{--bg-opacity:1;background-color:#f7fafc;background-color:rgba(247,250,252,var(--bg-opacity))}.bg-gray-200{--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.bg-gray-300{--bg-opacity:1;background-color:#e2e8f0;background-color:rgba(226,232,240,var(--bg-opacity))}.bg-blue-200{--bg-opacity:1;background-color:#bee3f8;background-color:rgba(190,227,248,var(--bg-opacity))}.bg-blue-300{--bg-opacity:1;background-color:#90cdf4;background-color:rgba(144,205,244,var(--bg-opacity))}.border-gray-400{--border-opacity:1;border-color:#cbd5e0;border-color:rgba(203,213,224,var(--border-opacity))}.border-gray-500{--border-opacity:1;border-color:#a0aec0;border-color:rgba(160,174,192,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.border-solid{border-style:solid}.border{border-width:1px}.border-t{border-top-width:1px}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.items-center{align-items:center}.justify-center{justify-content:center}.justify-around{justify-content:space-around}.float-left{float:left}.clearfix:after{content:"";display:table;clear:both}.clear-both{clear:both}.font-serif{font-family:Georgia,Cambria,"Times New Roman",Times,serif}.font-semibold{font-weight:600}.font-bold{font-weight:700}.h-64{height:16rem}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-base{font-size:1rem}.text-xl{font-size:1.25rem}.leading-none{line-height:1}.m-2{margin:.5rem}.my-3{margin-top:.75rem;margin-bottom:.75rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2{margin-bottom:.5rem}.mr-3{margin-right:.75rem}.mb-3{margin-bottom:.75rem}.mt-4{margin-top:1rem}.mb-4{margin-bottom:1rem}.mt-6{margin-top:1.5rem}.max-w-sm{max-width:24rem}.max-w-2xl{max-width:42rem}.object-contain{-o-object-fit:contain;object-fit:contain}.overflow-hidden{overflow:hidden}.p-1{padding:.25rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.pl-3{padding-left:.75rem}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}.shadow-inner{box-shadow:inset 0 2px 4px 0 rgba(0,0,0,.06)}.table-fixed{table-layout:fixed}.text-left{text-align:left}.text-center{text-align:center}.text-black{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity))}.text-gray-700{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.text-gray-800{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity))}.whitespace-no-wrap{white-space:nowrap}.w-1\/2{width:50%}.w-1\/4{width:25%}.w-4\/5{width:80%}.w-full{width:100%}.text-tiny{font-size:.5rem!important}body{color:#000!important;font-size:1.25rem!important}.main-content{max-width:900px}.lesson{padding-left:15px!important;padding-right:10px!important;--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.main-content,html{font-family:Arial,Georgia,Verdana,"Times New Roman"!important}.lesson-footer-card,.lesson-overview-card{font-family:"Times New Roman"!important}blockquote em:first-child{font-family:Times!important;font-size:1.35em;margin-right:10px}blockquote em:first-child:after{content:":"}.lesson-footer{margin-top:50px;margin-top:20px}table{border-spacing:10px;border:1px solid #666;border-collapse:collapse!important;margin-bottom:1em}td{padding:0 10px 10px 10px}thead{border:.5px solid #778899}table td+td{border-left:2px solid #778899}.lesson ol{list-style-type:decimal;list-style-position:inside;margin-left:1em}.lesson ul{list-style-position:inside;list-style-type:none;margin-left:1em}.lesson ul li{padding-left:1em;padding-right:5px}.lesson ul li::before{content:"‚Ä¢";padding-right:5px}span{white-space:nowrap}p.new{padding-top:0;padding-bottom:.5em}p.new+p{padding-top:.5em}h1,h2,h3,h4{font-weight:700;margin-top:.25em!important;margin-bottom:.05em!important;font-family:Georgia,Cambria,"Times New Roman",Times,serif!important}h1{font-size:2em!important;clear:both;color:#000!important}div+h1,h2{margin-top:0!important}h2{margin-top:.5em!important;font-size:1.5em!important;clear:both;color:#8b0000!important}h3{font-size:1.25em!important;clear:both;color:#006400!important}h4{font-size:1em!important;clear:both;color:#00008b!important}ul{margin-bottom:30px}p.new a{text-decoration:underline}.lesson a{text-decoration:underline;color:#00f}.title-text{font-size:2rem}blockquote{font-size:1em;background:#f9f9f9;border-left:10px solid #ccc;margin:.5em 10px;padding:.5em 10px;border-left-color:#ffcd69;border-right-color:#f6ba59;quotes:"\201C""\201D""\2018""\2019"}blockquote:before{color:#ccc;content:open-quote;font-size:4em;line-height:.1em;margin-right:.25em;vertical-align:-.4em}blockquote:after{color:#ccc;content:no-close-quote}blockquote p{display:inline}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.5)}img.center{-o-object-position:center;object-position:center;margin-left:auto;margin-right:auto}img.border{border:1px solid #021a40;margin-top:.5rem;margin-bottom:.75rem}img.iw500{height:auto;width:auto;max-width:500px}img.iw100{height:auto;width:auto;max-width:100px}code{font-size:smaller}pre code{font-size:15px}pre code:not(.line-number){background:#f4f4f4;font-family:monospace;font-size:15px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;touch-action:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;clear:both;border:1px solid #ddd;color:#666;page-break-inside:avoid;display:block;min-width:840px;max-width:840px;overflow:scroll;line-height:1.6;margin-bottom:1.6em;padding:1em 1.5em;-moz-tab-size:2;-o-tab-size:2;tab-size:2;word-wrap:break-word;white-space:pre-wrap;border-left:3px solid #f36d33}div.code-starter>pre code{border-left:3px solid #fdff44!important;background-image:radial-gradient(rgba(0,150,0,.75),#000 120%);color:#fff;font:.9rem Inconsolata,monospace}div.code-starter>pre code::after{content:"\a$_"}</style>
<script src="https://kit.fontawesome.com/7efc4bcee2.js" crossOrigin="anonymous"></script>
<script>
    let stateCheck = setInterval(function(){
      if (document.readyState === 'complete') {
        clearInterval(stateCheck);
        let s1 = document.getElementById('start');
        // console.log('doc is ready', s1);
        if (s1) {
           s1.setAttribute('tabindex', '-1');
           s1.focus(); 
           s1.scrollIntoView({behavior: 'smooth'}); 
           setTimeout(function(){s1.blur()}, 500);
           // console.log('focus set');
        }
      }
    }, 200);
    </script>
</head><body class="lesson"><div class="main-content lesson bg-gray-200 text-black p-1 pl-3 font-serif"><div class="md-inner">
<div id="start" class="section">&nbsp;</div><h1 class="overview"></h1><div class="lesson-overview bg-gray-200 flex justify-center"><div class="text-center px-4 py-2 m-2"><div class="lesson-overview-card displaycard bg-blue-200 max-w-sm rounded overflow-hidden shadow-lg"><div>¬†</div><img alt="Text" class="object-contain h-64 w-full" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/CodeChallenges-sm.png"/><div class="px-6 py-4"><div class="title-text text-center leading-none font-bold text-xl">Sports Analytics</div><p class="text-center mt-2 text-gray-800 text-xl">Baseball Fever</p><div class="text-gray-700 text-base">¬†</div><div class="text-center mb-3"><span class="inline-block bg-gray-300 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2">#info490</span><span class="inline-block bg-gray-300 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2">#projects</span></div><div class="flex border-t border-solid border-gray-500 shadow-inner justify-around bg-blue-300"><div class="text-gray-700 text-center px-4 m-2 text-sm"><span class="whitespace-no-wrap">D.M. &amp; the üêç</span></div><div class="text-gray-700 text-center px-4 m-2 text-sm"><span class="whitespace-no-wrap"><strong>Version:</strong> <!-- -->SP21</span></div></div><div class="text-gray-700 mt-1 text-center text-tiny">All Rights Reserved</div></div></div></div><div class="text-center px-4 py-2 m-2 w-1/2"><div class="displaycard bg-gray-200 max-w-sm rounded overflow-hidden shadow-lg"><div class="px-6 py-4 text-left"><div class="text-center font-bold text-xl">Sports Analytics<br/><div><span>prerequisites</span><div class="text-center text-xs mb-2">(start only after finishing)</div><p class="max-w-sm text-gray-800 text-sm">‚¶ø <strong>info490 pandas, matplotlib</strong></p><p class="max-w-sm text-gray-800 text-sm">‚¶ø <strong>color</strong></p><p class="max-w-sm text-gray-800 text-sm">‚¶ø <strong>cmaps</strong></p></div></div></div><div class="px-6 py-4 text-left text-gray-800"><div class="text-center font-bold text-xl">Colab Notes</div><p class="max-w-sm text-sm">1. <strong>Copy</strong> this notebook <img alt="copy2drive.png" class="inline-block" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/copy2drive.png"/></p><p class="max-w-sm text-sm">2. <strong>Update</strong> the <strong><code>NET_ID</code></strong> in the notebook</p><p class="max-w-sm text-gray-800 text-sm">3. <strong>Hit ‚ñ∂Ô∏è¬†</strong> to install the INFO 490 IDE</p><div class="text-center font-bold text-xl">¬†</div><div class="text-center font-bold text-xl">Jupyter/PyCharm Notes</div><p class="max-w-sm text-gray-800 text-sm text-left">The testing framework does <strong>not work</strong> (at this time) for Jupyter  notebooks or local code development.</p></div></div></div></div><h1 class="section" id="section1">Sports Analytics </h1><a href="https://www.seeclearassociates.com/the-science-of-the-swing/" target="_blank"><img alt="AdairSwing400.png" class="float-left border mb-4 mr-3" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/AdairSwing400.png"/></a><p class="new">Sports analytics is applying statistics, data science, machine learning to both
on-field and off-field sports related data.  The main goal is to somehow gain 
a competitive advantage (more wins, more fans, more revenue, more profit) by 
learning insights about a team or its competition.</p><p class="new">The field was popularized by the <a href="https://www.imdb.com/title/tt1210166" target="_blank">movie</a> Moneyball (2011) and 
has grown so fast that it has its own <a href="http://www.sloansportsconference.com" target="_blank">conference</a> each spring. </p><p class="new">In this lesson, we will focus on baseball analytics (plotting pitch location) but 
additional projects will touch on other sports as well.</p><h2 id="baseball-and-mlb-">Baseball and MLB </h2><p class="new">Probably the most analyzed and data rich sport is baseball.  The game of
 <a href="https://www.wikihow.com/Play-Baseball" target="_blank">baseball</a> is dissected 
for offensive (hitting, base running), pitching, and defense (e.g. positioning players based on the situation).  </p><p class="new">MLB (Major League Baseball) is the American professional baseball organization. 
It has a rich history of providing information on each game and has a strong community in
 <a href="https://sabr.org/sabermetrics" target="_blank">information and research</a>. One of the main
  reasons baseball enjoys a rich history of analysis is that in a typically game each 
  team will throw <a href="https://www.baseball-reference.com/blog/archives/7533.html" target="_blank">146</a> pitches.  In a 
  full season that's over 700,000 data points (146 * 160 games * 30 teams)!</p><h2 id="mlb-statcast-and-baseballsavant">MLB Statcast and BaseballSavant</h2><p class="new">Currently MLB provides <a href="https://www.mlb.com/stats/" target="_blank">basic statistical data</a> and
 <a href="https://baseballsavant.mlb.com" target="_blank">detailed data</a> via its baseballsavant page.
BaseballSavant is a window into the MLB's <a href="http://m.mlb.com/glossary/statcast" target="_blank">statcast</a> product which is the tracking technology installed in all 
30 baseball parks that provides the raw data.  Historically, you can get
 older baseball data that has been collected via box scores and humans 
 from <a href="https://www.retrosheet.org/" target="_blank">Retrosheet</a>.</p><h2 id="mlb-collection-hardware">MLB Collection Hardware</h2><p class="new">Statcast data is collected in all the MLB stadiums. The first generation
 (<a href="https://www.smt.com/baseball" target="_blank">PitchF/x</a>) tracked baseballs using three mounted cameras. 
 In 2017, the system was replaced with <a href="https://trackmanbaseball.com" target="_blank">TrackMan</a> that uses Doppler radar
  technology.  For the 2020 season, MLB is using a system called
   <a href="https://www.hawkeyeinnovations.com/about" target="_blank">Hawk-Eye</a> which is based on
    cameras and vision processing technology.  You can watch MLB's discussion
     of <a href="https://www.youtube.com/watch?v=ijF2npL_nsY" target="_blank">Statcast 2020</a> at the
      SBR Analytics Conference (the talk begins at the 2:38 mark). MLB progressive 
      improvements in hardware signal its commitment to producing the most accurate field data in sports.</p><h3 id="baseballsavant-walk-through-">BaseballSavant Walk through </h3><p class="new">MLB's baseballsavant is their web interface into the Statcast data.  If you're 
a baseball fan, there's plenty of information to view.  Let's walk through
some of the data and visualizations.</p><p class="new">The first example shows how you can drill down into the data to get to some
interesting visualizations.</p><ol start="1"><li>Go here: <a href="https://baseballsavant.mlb.com/leaderboard/custom?year=2019&amp;type=pitcher" target="_blank">https://baseballsavant.mlb.com/leaderboard/custom?year=2019&amp;type=pitcher</a></li><li>Enter/Select Minimum PA (250)</li><li>Select the <a href="http://m.mlb.com/glossary/statcast/expected-batting-average" target="_blank">xBA</a> 
column (expected batting average of opposing hitter) to sort the pitchers in
ascending order. 
<img alt="xBA.png" class="clear-fix border my-3" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/xBA.png"/></li><li>Select Justin Verlander to view some of his graphs (he may be further down the list) 
<img alt="jv2019.png" class="clear-fix border my-3" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/jv2019.png"/><br/>We will use some of this data later on in the lesson.</li></ol><h3 id="baseballsavant-visuals">BaseballSavant Visuals</h3><p class="new">Another way to see visualizations is to go through the 'visuals' menu.</p><h4 id="pitch-selection">Pitch Selection</h4><ol start="1"><li>Select 'Visuals' from the menu-bar
<img alt="visMenu.png" class="clear-fix border my-3" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/visMenu.png"/></li><li>Select 'Visual Pitcher Report'</li><li>Type in Justin Verlander and scroll down until you see the pitch report:
<img alt="JVpitches.png" class="clear-fix border my-3" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/JVpitches.png"/><br/></li></ol><p class="new">In baseball, the pitcher will throw different kinds of pitches in hopes of
 striking out the batter.  By having different pitches, allows the pitcher to 
 be unpredictable. Most MLB pitchers will have 3 to 4 pitches in their
  repertoire that they throw. </p><p class="new">There are 3 basic categories of pitches (fastballs, breaking balls, curve balls). 
The following is a good <a href="https://library.fangraphs.com/pitch-type-abbreviations-classifications" target="_blank">reference</a> to 
pitch types.  In addition, there are multiple places to <a href="https://lokeshdhakar.com/baseball-pitches-illustrated/" target="_blank">read</a> and 
<a href="http://probaseballinsider.com/baseball-instruction/fundamentals-of-hitting/types-of-baseball-pitches/" target="_blank">see</a> the differences. </p><p class="new">Statcast uses the following codes in their data:</p><p class="new"><strong>Fastballs</strong>:
  Cutter (FC)
  Splitter (FS)
  Forkball (FO)
  Four-Seam Fastball (FA)
  Two-Seam Fastball (FT)
  Sinker (SI)</p><p class="new"><strong>Change ups</strong>:
  Changeup (CH)</p><p class="new"><strong>Breaking Balls</strong>:
  Curveball (CU)
  Slider (SL)
  Screwball (SC)</p><p class="new"><strong>Misc.</strong>:
  Knuckle-ball (KN)
  Knuckle-curve (KC)
  Eephus/Slow-ball (EP)</p><h4 id="pitch-location">Pitch Location</h4><img alt="pitcherBatter.png" class="iw500 border float-left mr-3 mb-3" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/pitcherBatter.png"/><p class="new">The pitcher will stand on a 'mound' about 10" above the ground.  The batter
 is about 60 feet 6 inches away from the pitcher. The pitcher will attempt
  to throw the ball such that the hitter strikes out (doesn't hit the ball) or 
  hits the ball where the defense can make an out. </p><p class="new">  Where the ball crosses the plate is referred to as <strong>location</strong>. </p><br class="clear-both"/><p class="new">The next example shows the <strong>location</strong> of Justin Verlander's pitches:</p><div class="flex mb-3"><img alt="JVLocation.png" class="border float-left mr-3" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/JVLocation.png"/><div class="flex items-center justify-center text-sm w-1/4">Justin Verlander's pitch location as it crosses over the plate (2019, 3242 pitches)
</div></div><h4 id="pitch-movement">Pitch Movement</h4><p class="new">As the ball is moving from the pitcher to the catcher, it's flight is
 influenced (in addition to gravity) by it's spin, velocity, and the angle
  from which the ball leaves the pitcher's hand.  Ball <strong>'movement'</strong> looks at
   how much the ball moves due the pitcher's action.  For many of baseball's
    analyses, the influence that the pitcher has on the ball's movement is
     isolated.</p><div class="flex my-3"><img alt="JVMovement.png" class="border float-left mr-3" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/JVMovement.png"/><div class="flex items-center justify-center text-sm w-1/4">Justin Verlander's horizontal &amp; vertical movement with gravity in inches
(2019, 3242 pitches)
</div></div><p class="new">Be sure to notice the Y axis labels (not shown here) in the actual graphs.</p><h3 id="baseballsavant--search-and-download">BaseballSavant  (Search and download)</h3><p class="new">Luckily, we can download much of this data and do our own analysis.</p><ol start="1"><li>From the top menu bar, select the 'Search' item
<img alt="searchMenuBar.png" class="border" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/searchMenuBar.png"/></li><li>Enter in the following for Player Type, Season, and Pitcher:
<ul><li>Player Type: [Pitcher]</li><li>Season: [2019] (only 2019)</li><li>Pitchers: type in last name (Verlander) first, it's okay if it shows [2020 Verlander]</li><li>change included stats -&gt; leave them unchecked (it will include them all)</li></ul></li><li>Hit search</li><li>Once the results come, select save (last icon) to download the results
<img alt="downloadMenu.png" class="border" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/downloadMenu.png"/></li><li>The data will be saved to a file name 'savant_data.csv'</li><li>You should confirm that there are 3448 rows in the file  (use excel/sheets/Numbers)</li></ol><h1 class="section" id="section2">Lesson Assignment</h1><p class="new">One of the best ways to practice data analysis is to use an existing dataset
 where you can duplicate previous results. We are going to attempt to re-create the previous two charts (pitch location and pitch movement).</p><h2 id="step-1-data-confirmation-and-exploration">Step 1: Data Confirmation and Exploration</h2><p class="new">Let's load the data downloaded in the previous example in this notebook.  We
 can use Google's tools to upload the data.  Once the data is uploaded, 
 be sure to locate the data (use the 'file' icon on the left hand side).</p><div class="ide code-starter clearfix"><pre><code>import pandas as pd
import numpy as np
import matplotlib
import matplotlib.pyplot as plt

# upload the data from baseball savant 
def upload_data():
  from google.colab import files
  files.upload()

# upload_data()</code></pre></div><h2 id="step-2-data-access">Step 2: Data Access</h2><p class="new">Finish the implementations of the following two functions.  The function
 <code>print_pitch_counts</code> should print both the pitch type (e.g 'FF') and the
 total number for that type of pitch.</p><div class="ide code-starter clearfix"><pre><code>def load_data(filename):

    import LessonUtil as Util
    import os
   
    if not os.path.exists(filename):
        filename = Util.path_for_data(filename)
      
    # load filename into pandas
    # return the dataframe
    return None

def print_pitch_counts(df):
    # print pitch counts
    # any format will do but the easiest is just
    # to print out the result of the pandas operation
    # it should print out the pitch type (e.g. FF) and the count
    return None
    
def step2(fn):
    df = load_data(fn)
    print_pitch_counts(df)
    
# be sure to upload the file!
step2('./savant_data.csv')</code></pre></div><p class="new"> 
Once that is done, confirm that the following are correct</p><ul><li>1617 fastballs</li><li>929 Sliders</li><li>560 Curveballs</li><li>136 Changeups
<br/></li></ul><h2 id="step-3-pitch-location-over-plate">Step 3: Pitch Location over Plate</h2><p class="new">Take a look at columns <code>plate_x</code> and <code>plate_z</code>. These give the x and y coordinates 
of the pitch as it crosses home-plate. Finish the following two functions that
draws the scatter graph. </p><p class="new">Notes: (to match the graph shown) </p><ul><li>paint the graphs in order of count (i.e. fast balls first, then sliders, etc).</li><li>use a markersize of 10
<br/></li></ul><div class="ide code-starter clearfix"><pre><code>def build_color_map():
  # return a simple python dictionary
  # with the following mappings
  # CH: green (changeup)
  # CU: skyblue (curve)
  # FF: red (4 seam fastball)
  # SL: orange (slider)
  return {} 

def plot_pitch_location(df, cmap):
   # keep this line as is
   fig, axes = plt.subplots(nrows=1, ncols=1, figsize=(10,10)) 
   
   # be sure to drop any rows that have no data (e.g. use panda's dropna())
   
   return fig</code></pre></div><p class="new">As always, be sure to test</p><pre><code>def step3(fn):
    df = load_data(fn)
    cmap = build_color_map()
    fig = plot_pitch_location(df, cmap)
    
step3('./savant_data.csv')</code></pre><h2 id="step-4-pitch-movement-addingimg-classinline-iw100-srcimagesdmapprojectsbaseballanimated-ballgif">Step 4: Pitch Movement (adding<img alt="animated-ball.gif" class="inline iw100" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/animated-ball.gif"/>)</h2><p class="new">A pitcher's best chance of affecting ball movement (that is how much the ball
 moves if you remove the effects of gravity) is by adding spin to the ball.</p><p class="new">The table below gives some typical spin rates of different pitches and how
 much that spin contributes towards the baseball moving (beyond gravity).</p><table class="table-fixed text-sm w-4/5 mb-4"><thead><tr><th class="w-1/2 px-4 py-2">Pitch Speed and Type</th><th class="w-1/4 px-4 py-2">Spin Rate (rpm)</th><th class="w-1/4 px-4 py-2">Duration of Flight (ms)</th><th class="w-1/4 px-4 py-2">Drop due to Gravity (ft)</th><th class="w-1/4 px-4 py-2">Spin-Induced Vertical Drop (ft)</th><th class="w-1/4 px-4 py-2">Total Drop (ft)</th></tr></thead><tbody><tr><td class="border px-4 py-2">95 mph fastball</td><td class="border px-4 py-2">+1200</td><td class="border px-4 py-2">404</td><td class="border px-4 py-2">2.63</td><td class="border px-4 py-2">-0.91</td><td class="border px-4 py-2">1.72</td></tr><tr class="bg-gray-100"><td class="border px-4 py-2">85 mph slider</td><td class="border px-4 py-2">-1400</td><td class="border px-4 py-2">452</td><td class="border px-4 py-2">3.29</td><td class="border px-4 py-2">+0.74</td><td class="border px-4 py-2">4.03</td></tr><tr><td class="border px-4 py-2">75 mph curveball</td><td class="border px-4 py-2">+2000</td><td class="border px-4 py-2">513</td><td class="border px-4 py-2">4.24</td><td class="border px-4 py-2">+1.46</td><td class="border px-4 py-2">5.70</td></tr></tbody></table><p class="new">The following resources (if interested) provide an insight into the physics of baseball: </p><ul><li><a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.149.6357&amp;rep=rep1&amp;type=pdf" target="_blank">https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.149.6357&amp;rep=rep1&amp;type=pdf</a></li><li><a href="https://tht.fangraphs.com/pitch-movement-spin-efficiency-and-all-that/" target="_blank">https://tht.fangraphs.com/pitch-movement-spin-efficiency-and-all-that/</a>
<br/></li></ul><p class="new">In the Statcast data, the fields <code>pfx_x</code> and <code>pfx_z</code> are the horizontal and vertical movements.
These attributes are the result of the spin that the pitcher added to the
 ball.</p><p class="new">For this visualization, we are going to do the following:</p><ul><li>Use a <code>ListedColorMap</code> instead of a simple dictionary</li><li>You should try to match the colors baseball savant.  You can use <a href="https://imagecolorpicker.com/en/" target="_blank">https://imagecolorpicker.com/en/</a> to upload an image and pick colors.</li><li>Set the opacity to 0.4</li><li>Use a marker size of 10</li><li>There is an extra credit option as well (see next section)</li></ul><div class="ide code-starter clearfix"><pre><code>def build_listed_color_map():
  # implement me
  return None
  # return matplotlib.colors.ListedColormap( ... )

def plot_pitch_movement(df, lcmap):
    # keep this as is
    fig, axes = plt.subplots(nrows=1, ncols=1, figsize=(10,10))
    
    # build the plot
    
    return fig
    
def step4(fn):
    df = load_data(fn)
    cmap = build_listed_color_map()
    fig = plot_pitch_movement(df, cmap)</code></pre></div><p class="new">Once <code>step4</code> is working, what do you notice between the graph you created vs the 
one on the baseball savant page (the one shown above)?</p><h2 id="a-side-note-on-pitch-movement-for-the-curious">A Side Note on Pitch Movement (for the curious)</h2><p class="new">On the baseball savant page, it says 'Justin Verlander's horizontal &amp; vertical 
movement with gravity in inches'. The issue is that the <code>pfx_z</code> values in the 
downloaded data are 'Induced Vertical Break' values. That is, values with the 
effect of gravity <strong>removed</strong>.</p><blockquote><p class="new"><em><strong>Sport's Log</strong></em> There is no clear definition of the <code>pfx_z</code> field given to confirm the above other
 than visual inspection of the data. MLB's definition of pitch movement (<a href="http://m.mlb.com/glossary/statcast/pitch-movement" target="_blank">http://m.mlb.com/glossary/statcast/pitch-movement</a>)
does not align with its own definitions (<a href="https://baseballsavant.mlb.com/csv-docs" target="_blank">https://baseballsavant.mlb.com/csv-docs</a>) or with 
Trackman's (<a href="https://trackman.zendesk.com/hc/en-us/articles/115002776647-Radar-Measurement-Glossary-of-Terms" target="_blank">https://trackman.zendesk.com/hc/en-us/articles/115002776647-Radar-Measurement-Glossary-of-Terms</a>). 
<br/>However, the good people at Trackman did confirm the following: ‚ùùStatcast's
 pfxz represents the same measurement as
 Trackman's Induced Vertical Break, not Trackman's pfxz.‚ùû</p></blockquote><p class="new">A few quick definitions:</p><ul><li><strong>Vertical Break</strong>: the actual pitch compared to a theoretical pitch with no gravity.</li><li><strong>Induced Vertical Break</strong>: the actual pitch compared to a theoretical pitch
affected by gravity.</li></ul><p class="new">Basically, induced vertical break allows one to understand how much the
 pitcher is actually influencing the movement of the ball.</p><p class="new">A reference to a 'rising' pitch, just means the ball didn't fall/drop as much as
 one might predict or calculate.  A reference to a 'drop' means the ball fall/drop 
more than what one might predict or calculate.</p><p class="new">The image below attempts to clarify the definitions:
<img alt="break.png" class="w-full border center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/projects/baseball/html/break.png"/></p><p class="new">Why is all this important?  One of your responsibilities as a data scientist, is to learn, 
live and breath the data.  If you are hired for a data analysis job or working in that 
capacity, taking the effort and time to learn as much as you can about the data will put 
you in the role of being an expert. </p><h2 id="extra-credit">Extra Credit</h2><p class="new">Receive extra credit if your <code>plot_pitch_movement</code> function only calls <code>scatter</code> once.<br/>That is, to plot the data there is only a single runtime call to <code>axes.scatter</code> (no loops).</p><h1>Test and Submit</h1><p>Once you have finished, you can download your code (via <code>ide.tester</code>) and upload that file to Gradescope (find lesson with tag <strong>baseball</strong>).</p><div class="my-4"><pre><code><strong># to list the tests available</strong><br/>print(ide.tester.list_tests())<br/><strong># to perform a specific test</strong><br/>print(ide.tester.test_functionality('name of test'))<br/><strong># to test your code (either works)</strong><br/>print(ide.tester.test_notebook())<br/>print(ide.tester.test_notebook(verbose=True))<br/><strong># to prepare and download your code</strong><br/>ide.tester.download_solution()</code></pre></div><div class="lesson-footer flex bg-gray-200 justify-center"><div class="lesson-footer-card displaycard bg-blue-200 border-t border-gray-400 max-w-2xl rounded overflow-hidden shadow-lg"><div class="px-6 py-4"><div class="title-text text-center font-bold text-xl">Sports Analytics</div><p class="text-center text-gray-800 text-xl">Baseball Fever</p><div class="text-center mt-6 text-xl"><i aria-hidden="true" class="fas fa-tags"></i> any questions on Piazza with <span class="font-bold">baseball</span></div><div class="text-gray-700 text-base">¬†</div><div></div><div></div><div class="flex mt-4 border-t border-solid border-gray-500 justify-around bg-gray-200"><div class="text-gray-700 text-center px-4 m-2 text-sm">D.M. &amp; the üêç</div><div class="text-gray-700 text-center px-4 m-2 text-sm"><strong>Version:</strong> <!-- -->SP21</div></div><div class="text-gray-700 mt-2 text-center text-sm font-bold">All Rights Reserved Michael Haberman</div><div class="text-gray-700 text-center text-sm">Do not distribute this notebook</div></div></div></div><div>¬†</div><div class="ide code-starter clearfix"><pre><code># print(ide.tester.test_notebook()) 
# print(ide.tester.test_notebook(verbose=True)) 

# once you are ready -- run this 
# ide.tester.download_solution() 
</code></pre></div></div></div></body></html>
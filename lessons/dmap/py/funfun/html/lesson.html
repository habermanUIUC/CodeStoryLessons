<!DOCTYPE html><html lang='en'><head><title>Functional Fun</title><meta charset="utf-8"><style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}strong{font-weight:bolder}code{font-family:monospace,monospace;font-size:1em}img{border-style:none}input{font-family:inherit;font-size:100%;line-height:1.15;margin:0}input{overflow:visible}[type=checkbox]{box-sizing:border-box;padding:0}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}h1,h2,h3,p,pre{margin:0}ol,ul{list-style:none;margin:0;padding:0}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e2e8f0}img{border-style:solid}input:-ms-input-placeholder{color:#a0aec0}input::-ms-input-placeholder{color:#a0aec0}input::-moz-placeholder{color:#a0aec0}h1,h2,h3{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}input{padding:0;line-height:inherit;color:inherit}code,pre{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}img{display:block;vertical-align:middle}img{max-width:100%;height:auto}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.bg-gray-200{--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.bg-gray-300{--bg-opacity:1;background-color:#e2e8f0;background-color:rgba(226,232,240,var(--bg-opacity))}.bg-orange-300{--bg-opacity:1;background-color:#fbd38d;background-color:rgba(251,211,141,var(--bg-opacity))}.bg-green-200{--bg-opacity:1;background-color:#c6f6d5;background-color:rgba(198,246,213,var(--bg-opacity))}.bg-blue-200{--bg-opacity:1;background-color:#bee3f8;background-color:rgba(190,227,248,var(--bg-opacity))}.bg-blue-300{--bg-opacity:1;background-color:#90cdf4;background-color:rgba(144,205,244,var(--bg-opacity))}.border-gray-400{--border-opacity:1;border-color:#cbd5e0;border-color:rgba(203,213,224,var(--border-opacity))}.border-gray-500{--border-opacity:1;border-color:#a0aec0;border-color:rgba(160,174,192,var(--border-opacity))}.border-indigo-500{--border-opacity:1;border-color:#667eea;border-color:rgba(102,126,234,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.border-solid{border-style:solid}.border{border-width:1px}.border-l-2{border-left-width:2px}.border-t{border-top-width:1px}.cursor-pointer{cursor:pointer}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.justify-center{justify-content:center}.justify-around{justify-content:space-around}.float-left{float:left}.clearfix:after{content:"";display:table;clear:both}.font-sans{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}.font-serif{font-family:Georgia,Cambria,"Times New Roman",Times,serif}.font-semibold{font-weight:600}.font-bold{font-weight:700}.h-64{height:16rem}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-base{font-size:1rem}.text-xl{font-size:1.25rem}.leading-none{line-height:1}.leading-normal{line-height:1.5}.m-2{margin:.5rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-3{margin-bottom:.75rem}.mt-4{margin-top:1rem}.mb-4{margin-bottom:1rem}.mt-6{margin-top:1.5rem}.max-w-sm{max-width:24rem}.max-w-2xl{max-width:42rem}.object-contain{-o-object-fit:contain;object-fit:contain}.opacity-0{opacity:0}.overflow-hidden{overflow:hidden}.p-1{padding:.25rem}.p-2{padding:.5rem}.p-3{padding:.75rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.pl-3{padding-left:.75rem}.absolute{position:absolute}.shadow-md{box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06)}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}.shadow-inner{box-shadow:inset 0 2px 4px 0 rgba(0,0,0,.06)}.text-left{text-align:left}.text-center{text-align:center}.text-black{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity))}.text-gray-700{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.text-gray-800{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity))}.whitespace-no-wrap{white-space:nowrap}.w-1\/2{width:50%}.w-2\/3{width:66.666667%}.w-full{width:100%}@media (min-width:768px){.md\:w-2\/3{width:66.666667%}}.text-tiny{font-size:.5rem!important}body{color:#000!important;font-size:1.25rem!important}.main-content{max-width:900px}.lesson{padding-left:15px!important;padding-right:10px!important;--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.main-content,html{font-family:Arial,Georgia,Verdana,"Times New Roman"!important}.lesson-footer-card,.lesson-overview-card{font-family:"Times New Roman"!important}.lesson-footer{margin-top:50px;margin-top:20px}.lesson ol{list-style-type:decimal;list-style-position:inside;margin-left:1em}.lesson ul{list-style-position:inside;list-style-type:none;margin-left:1em}.lesson ul li{padding-left:1em;padding-right:5px}.lesson ul li::before{content:"•";padding-right:5px}span{white-space:nowrap}p.new{padding-top:0;padding-bottom:.5em}p.new+p{padding-top:.5em}h1,h2,h3{font-weight:700;margin-top:.25em!important;margin-bottom:.05em!important;font-family:Georgia,Cambria,"Times New Roman",Times,serif!important}h1{font-size:2em!important;clear:both;color:#000!important}div+h1,h2{margin-top:0!important}h2{margin-top:.5em!important;font-size:1.5em!important;clear:both;color:#8b0000!important}h3{font-size:1.25em!important;clear:both;color:#006400!important}ul{margin-bottom:30px}p.new a{text-decoration:underline}.lesson a{text-decoration:underline;color:#00f}.title-text{font-size:2rem}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.5)}img.wrap{margin-right:1rem!important;border:1px solid #021a40}img.center{-o-object-position:center;object-position:center;margin-left:auto;margin-right:auto}img.border2{border:1px solid #94add4;margin-top:.5rem;margin-bottom:.75rem}img.iw400{height:auto;width:auto;max-width:400px}code{font-size:smaller}pre code{font-size:15px}pre code:not(.line-number){background:#f4f4f4;font-family:monospace;font-size:15px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;touch-action:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;clear:both;border:1px solid #ddd;color:#666;page-break-inside:avoid;display:block;min-width:840px;max-width:840px;overflow:scroll;line-height:1.6;margin-bottom:1.6em;padding:1em 1.5em;-moz-tab-size:2;-o-tab-size:2;tab-size:2;word-wrap:break-word;white-space:pre-wrap;border-left:3px solid #f36d33}div.code-starter>pre code{border-left:3px solid #fdff44!important;background-image:radial-gradient(rgba(0,150,0,.75),#000 120%);color:#fff;font:.9rem Inconsolata,monospace}div.code-starter>pre code::after{content:"\a$_"}.tab{font-size:1rem;border-color:#8c6728}.tab-content{max-height:0;max-width:100%;transition:max-height .35s}.tab input:checked~.tab-content{max-height:100vh}.tab input:checked+label{padding:1rem;border-left-width:2px;border-color:#6574cd;background-color:#f8fafc;color:#6574cd}.tab label::after{float:right;right:0;top:0;display:block;width:1em;height:1.5em;line-height:1.5;font-size:1rem;text-align:center;transition:all .35s}.tab input[type=checkbox]+label::after{content:"+";font-weight:700;border-width:1px;border-radius:9999px;border-color:#8c6728}.tab input[type=checkbox]:checked+label::after{transform:rotate(315deg);background-color:#6574cd;color:#f8fafc}</style>
<script src="https://kit.fontawesome.com/7efc4bcee2.js" crossOrigin="anonymous"></script>
<script>
    let stateCheck = setInterval(function(){
      if (document.readyState === 'complete') {
        clearInterval(stateCheck);
        let s1 = document.getElementById('start');
        // console.log('doc is ready', s1);
        if (s1) {
           s1.setAttribute('tabindex', '-1');
           s1.focus(); 
           s1.scrollIntoView({behavior: 'smooth'}); 
           setTimeout(function(){s1.blur()}, 500);
           // console.log('focus set');
        }
      }
    }, 200);
    </script>
</head><body class="lesson"><div class="main-content lesson bg-gray-200 text-black p-1 pl-3 font-serif"><div class="md-inner">
<div id="start" class="section">&nbsp;</div><h1 class="overview"></h1><div class="lesson-overview bg-gray-200 flex justify-center"><div class="text-center px-4 py-2 m-2"><div class="lesson-overview-card displaycard bg-blue-200 max-w-sm rounded overflow-hidden shadow-lg"><div> </div><img alt="Text" class="object-contain h-64 w-full" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/py/funfun/html/PythonFiles-sm.png"/><div class="px-6 py-4"><div class="title-text text-center leading-none font-bold text-xl">Functional Fun</div><p class="text-center mt-2 text-gray-800 text-xl">higher order functions</p><div class="text-gray-700 text-base"> </div><div class="text-center mb-3"><span class="inline-block bg-gray-300 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2">#info490</span><span class="inline-block bg-gray-300 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2">#python</span></div><div class="flex border-t border-solid border-gray-500 shadow-inner justify-around bg-blue-300"><div class="text-gray-700 text-center px-4 m-2 text-sm"><span class="whitespace-no-wrap">D.M. &amp; the 🐍</span></div><div class="text-gray-700 text-center px-4 m-2 text-sm"><span class="whitespace-no-wrap"><strong>Version:</strong> <!-- -->SP21</span></div></div><div class="text-gray-700 mt-1 text-center text-tiny">All Rights Reserved</div></div></div></div><div class="text-center px-4 py-2 m-2 w-1/2"><div class="displaycard bg-gray-200 max-w-sm rounded overflow-hidden shadow-lg"><div class="px-6 py-4 text-left"><div class="text-center font-bold text-xl">Functional Fun<br/><span></span></div></div><div class="px-6 py-4 text-left text-gray-800"><div class="text-center font-bold text-xl">Colab Notes</div><p class="max-w-sm text-sm">1. <strong>Copy</strong> this notebook <img alt="copy2drive.png" class="inline-block" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/py/funfun/html/copy2drive.png"/></p><p class="max-w-sm text-sm">2. <strong>Update</strong> the <strong><code>NET_ID</code></strong> in the notebook</p><p class="max-w-sm text-gray-800 text-sm">3. <strong>Hit ▶️ </strong> to install the INFO 490 IDE</p><div class="text-center font-bold text-xl"> </div><div class="text-center font-bold text-xl">Jupyter/PyCharm Notes</div><p class="max-w-sm text-gray-800 text-sm text-left">The testing framework does <strong>not work</strong> (at this time) for Jupyter  notebooks or local code development.</p></div></div></div></div><h1 class="section" id="section1">Functional Fun</h1><h2 id="higher-order-functions">higher order functions</h2><div class="float-left"><img alt="lambda.png" class="sm wrap" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/py/funfun/html/lambda.png"/><span class="text-tiny">image credit: Real Python</span></div><p class="new">You may have heard of the phrase 'functional programming' and since
almost everything we have done involves writing functions, you might
be wondering if we are doing 'functional programming'.  We are not ☹️ (well maybe a little). </p><p class="new">Python supports many styles of programming (e.g. procedural, object-oriented,
and functional).  These styles are different paradigms that can be used to build software. 
This lesson looks at some aspects of functional programming in Python.</p><p class="new">To write a program (or solution) 'functionally', the following requirements need to be met:</p><ol start="1"><li>Everything is a function</li><li>Functions cannot change global state (they can only act on their input). This is sometimes referred as no side effects or 'pure' functions.</li><li>There's a lack (or absence) of variables</li><li>There is no looping (recursion, is used). <em>Recursion</em> is when a function
contains a call to the same function!</li></ol><br/><p class="new">Some examples of languages that are 'functional' include Lisp, Scheme, and Haskell.  Below
is a snippet of Lisp that appends two lists together:</p><pre><code>(defun myappend (L1 L2)
   (cond
      ; error checking
      ((not (listp L1)) (format t "1st argument is not a list~%" L1))
      ((not (listp L2)) (format t "2nd argument is not a list~%" L2))
      ; base cases
      ((null L1) L2)
      ((null L2) L1)
      ; general case, neither list is empty
      (t (cons (car L1) (myappend (cdr L1) L2)))))</code></pre><p class="new">If you look closely, you can see the use of many functions (e.g. <code>not</code>, <code>cons</code>, <code>car</code>, <code>cdr</code>), 
conditionals (e.g. <code>cond</code>), booleans (e.g the <code>t</code>) and recursion (<code>myappend</code> <em>calls</em> <code>myappend</code>).</p><p class="new">At this point, you might be thankful Python has become the language of choice
 for data science:</p><pre><code># append two lists
list_c = list_a + list_b 
# that was easy</code></pre><p class="new">In order for a language to support functional programming, functions must
be treated as first-class objects. That means that functions can accept functions
as parameters and return functions (a.k.a. higher order functions).  The idea that a variable 
can 'hold' or store a function is part of being a 'first class' citizen in a language.</p><div class="ide code-starter clearfix"><pre><code>def some_fun(n):
   return n+1

# assign a function to a variable
other_fun = some_fun
print(other_fun(2))</code></pre></div><p class="new">You might also hear terms like lambdas, closures, decorators, currying and partial evaluation as well to 
describe some features of functional programming. Those concepts are hard to understand without setting 
up a situation where it's useful and relevant. They will come in due time. But we have used lambda 
functions before (e.g. the sorting lesson) so we can start there.</p><h1 class="section" id="section2">Lambda Functions 𝜆</h1><p class="new">We have been creating and using functions from the very first lessons of INFO 490.  When you create a 
function, that function is stored in memory and is available for the duration of the running program.<br/>Sometimes we want to create a function that is unnamed (called anonymous functions) that are only 
needed once.  They are sometimes referred to as 'throw away' functions. </p><p class="new">These simple, short-lived functions are called <em>lambda</em> functions.  The word lambda comes 
from mathematics (𝜆 calculus) for using a very concise notation for working with the concept of 
applying functions to arguments.</p><p class="new">And you create them using the following syntax:<br/></p><p class="new"><strong><code>lambda</code></strong> <code>argument_list: expression</code></p><ul><li><strong><code>lambda</code></strong> is a keyword</li><li>followed by the parameters (called bound variables -- its value depends on how/when the function is invoked)</li><li>the <strong>:</strong></li><li>the body of the function</li></ul><p class="new">Probably the hardest thing to remember is that you <strong>do not</strong> use a <code>return</code> statement. </p><h2 id="-uses">𝜆 uses</h2><p class="new">Probably the most visible and viable use for the lambda function is in <strong>key</strong> functions -- those  higher order functions
that have a <code>key</code> named argument:</p><div class="ide code-starter clearfix"><pre><code>print( min(['python', 'programming'], key=len) )
print( min(['python', 'programming'], key=lambda x: len(x)) )</code></pre></div><p class="new">You have used <code>sorted</code>, <code>sort</code>, <code>min</code>, <code>max</code> before in previous lessons. They all 
take an optional key argument for custom access and behavior. </p><p class="new">You can also simply define and call a lambda function in one statement:</p><pre><code>x_sq = (lambda x: x**2)(4)</code></pre><p class="new">You can assign a lambda function to a variable (it's <em>first</em> class) and use it like any other function:</p><div class="ide code-starter clearfix"><pre><code>def add_two(a, b):
  return a + b

add_two(3, 4)

sum_two = lambda a,b: a+b
assert sum_two(1,2) == add_two(1,2), 'bad functions'</code></pre></div><p class="new">The <code>sum_two</code> variable in the above code example holds the value of a lambda function.<br/>However, instead of assigning a <code>lambda</code> function to a variable it is usually defined inline 
and passed to another function. </p><h2 id="vowel-exercise">Vowel Exercise</h2><p class="new">In the function <code>vowel_exercise</code> write a <code>lambda</code> function whose parameter is a letter, 
it returns <code>True</code> if the letter is a vowel (a,e,i,o,u), <code>False</code> otherwise.</p><ul><li>Assign the lambda function to a variable named <code>is_vowel</code></li><li>return the lambda function</li></ul><p class="new">Here's how it will be used:</p><pre><code>def test_vowel(some_letter):
   fn = vowel_exercise()
   return fn(some_letter)
   
print(test_vowel('a'))</code></pre><div class="ide code-starter clearfix"><pre><code>def vowel_exercise():
    pass</code></pre></div><p class="new">Although you don't NEED to use lambda functions, you will inevitably come across them (very soon)
and it's important that you understand how to read the syntax and use them.</p><h1 class="section" id="section3">Filter</h1><p class="new">There are many times you will be given a list of items and you want to filter out (or keep a subset) 
some of them.  The Python function <code>filter</code> is a valuable helper. The <code>filter</code> function is a higher
order function since the first parameter is another function. The function you pass to <code>filter</code> simply 
returns a boolean that indicates whether to keep the item in the collection or not.</p><p class="new">The <code>filter</code> function accepts a function and a sequence (e.g. list). It then returns an 
iterator (a 'virtual' list) of values that passed through the filter. </p><p class="new">The interesting part of filter is that that function passed to it, will be given 
a value from the list and must return <code>True</code> if it is to be included. That function 
is usually defined as a lambda function. It doesn't have to be (it could be a regular 
defined function), but it's usually the case that you don't want to define a 
named function for a single use.</p><p class="new">Here's a quick example of the <code>filter</code> function.  Can you figure out what it returns?</p><div class="ide code-starter clearfix"><pre><code>numbers = range(1,10)
mystery = filter(lambda x: x%3 == 0, numbers)
print(list(mystery))</code></pre></div><p class="new">A few things to note 📝:</p><ul><li><code>filter</code> returns an iterator object, not a list. You must convert the result 
to a list (or simply iterate through the result)</li><li>the second argument to <code>filter</code> is a list (or an iterable object)</li><li>the function you pass to <code>filter</code> is called for each item in the given list</li></ul><h2 id="exercise-getvowels">Exercise <code>get_vowels</code></h2><p class="new">Create a function named <code>get_vowels</code> that uses your <code>vowel_exercise</code> function
 written previously:</p><ul><li>the argument to <code>get_vowels</code> is a string</li><li><code>get_vowels</code> <strong>must</strong> call your <code>vowel_exercise</code> and use the returned function</li><li><code>get_vowels</code> <strong>must</strong> use the <code>filter</code> function</li><li><code>get_vowels</code> returns a list of vowels that are contained in the parameter</li><li><code>get_vowels("Hello Illinois")</code> would return <code>['e', 'o', 'I', 'i', 'o', 'i']</code></li></ul><div class="ide code-starter clearfix"><pre><code>def get_vowels(txt):
    return []</code></pre></div><h1 class="section" id="section4">Map and Reduce</h1><p class="new">A popular programming model to process large amounts of data in parallel is map/reduce.  The idea 
is divide a problem (i.e. large dataset) into independent units of work (i.e. map).  Then have separate 
machines process the smaller unit of work and then combine them (i.e. reduce) to generate a result.  You
can read <a href="http://static.googleusercontent.com/media/research.google.com/es/us/archive/mapreduce-osdi04.pdf" target="_blank">Google's original Map Reduce Paper (2004)</a>
if you are interested in the origins of the concept.  A <a href="https://research.google.com/archive/mapreduce-osdi04-slides/index.html" target="_blank">small presentation</a> of
the paper is available as well.</p><img alt="map_reduce.png" class="center iw400" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/py/funfun/html/map_reduce.png"/><p class="new">Python supports this model of programming -- although we won't show how to do parallel programming (yet) with both <code>map</code> and 
<code>reduce</code> implementations.  Map/Reduce is part of the functional approach to programming.</p><h2 id="mapping-data">Mapping Data</h2><p class="new">The <code>map</code> function is another higher order function that applies a provided (usually lambda) function to every 
element in a sequence.</p><p class="new">This is the way we have been doing it:</p><pre><code>def old_way(fn, numbers):
  out = []
  for i in numbers:
    out.append(fn(i))
  return out

# let's double our numbers
print(old_way(lambda x: x*2, [1,2,3]))</code></pre><p class="new">However, the built in <code>map</code> function in Python does essentially the same thing (although it returns an 
iterator rather than a list) but is more efficient: </p><div class="ide code-starter clearfix"><pre><code>print(list(map(lambda x: x*2, [1,2,3])))</code></pre></div><p class="new">Since <code>map</code> returns an iterator, we need to convert it to a list to print it out.</p><p class="new">We can even use map to generate a set of numbers with multiple sequences:  </p><pre><code>a = [1, 2, 3, 4]
b = [17, 12, 11, 10]
c = [-1, -4, 5, 9]
out = list(map(lambda x, y, z : 2.5*x + 2*y - z, a, b, c))
print(out)</code></pre><div class="ide code-starter clearfix"><pre><code># be sure to run the above code example</code></pre></div><p class="new">Here <code>map</code> is working on 3 sequences, hence the <code>lambda</code> function receives 3 parameters as well.</p><h3 id="fair-warning">Fair Warning</h3><p class="new">Both <code>filter</code> and <code>map</code> return iterators that can only be used once.  So if
 you print out the results of either, be sure to comment out the print
 statement before you use it in an expression:</p><div class="ide code-starter clearfix"><pre><code>m1 = map(lambda x: x*2, [1,2,3])
print('v1', list(m1))
print('v2', list(m1))</code></pre></div><h2 id="reducing-data">Reducing Data</h2><p class="new">The <code>reduce</code> function is the counterpart/complement to <code>map</code>. It takes three arguments:</p><p class="new"><code>reduce(function, sequence, initial_value)</code></p><ul><li><code>function</code> is applied to each element in the sequence</li><li><code>function</code> needs to return a value that can be reduced (e.g. added, appended) with the initial_value</li><li><code>initial_value</code> is optional</li><li>the returned value is some sort of accumulation/summarization of all the results</li></ul><p class="new">Let's look at some simple examples so we can get a feel for all of this: that is, to take a sequences of 
items and reduces it to a single value:</p><pre><code>from functools import reduce
from operator import add

total = reduce(add, [1, 2, 3, 4])
print(total)</code></pre><ul><li>The function <code>add</code> is exactly what you expect it to be: <code>add = lambda a,b: a+b</code></li><li>the <code>operator</code> module provides many of the atomic units of operations as functions. 
It exports a set of efficient functions corresponding to the intrinsic operators of Python</li><li>the <code>reduce</code> function is  <strong>not</strong> part of the default Python distribution
and comes from the module <code>functools</code></li></ul><p class="new">As another example, suppose we wanted to count the total number of characters in each word in a sentence</p><div class="ide code-starter clearfix"><pre><code>from functools import reduce

# sum up the number of letters in all the words
words = "The rain in Spain falls mainly on the plains".split()
tot = reduce(lambda t, w: t + len(w), words, 0)
print("char count", tot)</code></pre></div><p class="new">This example reminds us that the function you pass to <code>reduce</code> will receive 
two arguments: the current 'reduced' value (initially set to 0 or <code>initial_value</code>) and 
the current item being processed.</p><h2 id="exercise--">Exercise:  </h2><p class="new">Create a function named <code>sum_of_squares</code> such that </p><ul><li>uses <code>map</code> to build a mapper with each item in <code>sequence</code> squared</li><li>uses <code>reduce</code> to mapper with each item in <code>sequence</code> squared</li><li>do not use <code>list</code></li><li>only use lambda functions</li></ul><div class="ide code-starter clearfix"><pre><code># provide answer here</code></pre></div><p class="new">You would test it like this:</p><pre><code>print(sum_of_squares(range(1,5)) == 30)</code></pre><h2 id="map-with-reduce-for-obfuscation-">Map with Reduce for Obfuscation </h2><p class="new">Here is another example of combining both <code>map</code> and <code>reduce</code> to show an efficient
 reduction of a problem. </p><p class="new">Let's start with a list of strings (an excerpt from the Zen of Python):</p><div class="ide code-starter clearfix"><pre><code>zen = ['beautiful is better than ugly',
       'explicit is better than implicit',
       'simple is better than complex',
       'complex is better than complicated',
       'flat is better than nested',
       'sparse is better than dense',
       'readability counts']
       
print(zen)</code></pre></div><p class="new">What we want to do is count the total number of words in all these strings. </p><ul><li><code>map</code> to convert the list of strings into a sequence of number-of-words values for each string</li><li><code>reduce</code> to convert the list of lengths to a single total number-of-words</li><li>return the value from <code>reduce</code></li></ul><p class="new">See if you can code it up (solution is given in the next section)</p><pre><code>def zen_of_python(zen):</code></pre><div class="ide code-starter clearfix"><pre><code>def zen_of_python(zen):
    pass</code></pre></div><pre><code>total = reduce(add, map(lambda x: len(x.split(' ')), zen))
print(total)</code></pre><ul><li><code>len(x.split(' '))</code> is the number of words in the string</li><li><code>map</code> simply returns an array of numbers</li><li><code>reduce</code> simply adds those numbers up</li></ul><h2 id="why-even-bother-with-mapreduce">Why even bother with map/reduce?</h2><p class="new">You may have asked: couldn't we just use comprehensions?</p><pre><code>simple_filter = [x for x in some_list if x%3 == 0]

simple_map    = [some_function(x) for x in some_list]

simple_reduce = sum(some_list_of_numbers)</code></pre><p class="new">Those are all certainly easier to read. One can argue that <code>filter</code> and <code>map</code> have 
nice comprehension equivalences, but <code>reduce</code> can be tricky.  Even the inventor 
of Python didn't think these (<code>map</code>, <code>filter</code>, <code>reduce</code>) belonged in the 
language (<a href="https://developers.slashdot.org/story/13/08/25/2115204/interviews-guido-van-rossum-answers-your-questions" target="_blank">read here)</a>.</p><p class="new">This is why <code>reduce</code> was reduced to the module <code>functools</code>.</p><p class="new">In the above counting words example, we could have simply concatenated all our input 
strings together, and removed the need to use map/reduce. However, if the situation 
was processing a massive database with millions of sentences using those techniques 
would require an equal amount of memory to store and process the data.</p><p class="new">The <code>map</code> function uses lazy iteration which means it doesn't load all the data into memory. 
We only ever need to store one sentence in memory at a time. </p><p class="new">Another advantage is that every map operation is independent. That is the beauty 
of functional programming. We can map the data in any order because there are no 
side effects. If we wanted, we could split our database into parts, and run <code>map</code> 
on several different computers, each processing its own section of the database. </p><p class="new">A final computer could run the <code>reduce</code> task, speeding the whole process up by many times.</p><p class="new">Without a map/reduce framework (like Hadoop), it's a bit hard to see the run-time 
payoffs of using these functional primitives.</p><p class="new">The map/reduce pattern is often used in big data applications because it allows for large scale 
parallelism of data processing. This distributed system programming model
 allows different machines to process different partitions of data.</p><p class="new">But even on smaller data sets, it is an interesting way of breaking problems 
down into functional units. </p><h1 class="section" id="section5">A Functional mindset</h1><p class="new">Although we will not be fully embracing the functional paradigm in its purest form, 
the tenets of making functions narrowly scoped (that is they only do one thing), 
don't change global state, and are not tightly coupled with other functions (i.e. 
functions only work if other functions have been called), are all very important 
software design elements.</p><p class="new">We will soon be creating our own user types (i.e. classes) and the same ideals 
will be used: break down your tasks as narrow as possible using functions.</p><h3 id="review">Review</h3><div class="font-sans container mt-1 mb-4 "><p>🎗Before you go, you should <strong>know</strong>:</p><div class="w-2/3 md:w-2/3"><div class="shadow-md"><div class="tab overflow-hidden border-t bg-green-200"><input class="absolute opacity-0" id="tab-multi-20" name="tabs" type="checkbox"/><label class="block p-3 leading-normal cursor-pointer" for="tab-multi-20"><span> What does functional programming mean? </span></label><div class="tab-content overflow-hidden border-l-2 bg-orange-300 border-indigo-500 leading-normal"><p class="p-3"><span>the answer is <strong>here</strong></span></p></div></div><div class="tab overflow-hidden border-t bg-green-200"><input class="absolute opacity-0" id="tab-multi-21" name="tabs" type="checkbox"/><label class="block p-3 leading-normal cursor-pointer" for="tab-multi-21"><span> How do you use <strong><code>filter</code></strong></span></label><div class="tab-content overflow-hidden border-l-2 bg-orange-300 border-indigo-500 leading-normal"><p class="p-3">No Answer</p></div></div><div class="tab overflow-hidden border-t bg-green-200"><input class="absolute opacity-0" id="tab-multi-22" name="tabs" type="checkbox"/><label class="block p-3 leading-normal cursor-pointer" for="tab-multi-22"><span> How do you use <strong><code>map</code></strong> </span></label><div class="tab-content overflow-hidden border-l-2 bg-orange-300 border-indigo-500 leading-normal"><p class="p-3"><span>the answer is <strong>here</strong></span></p></div></div><div class="tab overflow-hidden border-t bg-green-200"><input class="absolute opacity-0" id="tab-multi-23" name="tabs" type="checkbox"/><label class="block p-3 leading-normal cursor-pointer" for="tab-multi-23"><span> How do you use <strong><code>reduce</code></strong></span></label><div class="tab-content overflow-hidden border-l-2 bg-orange-300 border-indigo-500 leading-normal"><p class="p-3">No Answer</p></div></div><div class="tab overflow-hidden border-t bg-green-200"><input class="absolute opacity-0" id="tab-multi-24" name="tabs" type="checkbox"/><label class="block p-3 leading-normal cursor-pointer" for="tab-multi-24"><span> What problems lend themselves to using map/reduce paradigm </span></label><div class="tab-content overflow-hidden border-l-2 bg-orange-300 border-indigo-500 leading-normal"><p class="p-3">No Answer</p></div></div></div></div></div><h1 class="section" id="section6">Lesson Assignment</h1><p class="new">Let's use the filter, map, reduce paradigm to determine which states have at
 least 10% of their population test positive for Covid-19.</p><h2 id="the-data-">The Data </h2><p class="new">The <code>LessonUtil</code> object can get you access to a table (list of lists) of the
 data. The data was taken from <a href="https://www.worldometers.info/coronavirus/country/us/" target="_blank">https://www.worldometers.info/coronavirus/country/us/</a>
on 01.22.2021. The following is a list of the columns in the dataset: </p><pre><code>0 id #
1 USA State
2 Total Cases
3 Total Deaths
4 Total Recovered
5 Active Cases
6 Tot Cases/1M pop
7 Deaths/1M pop
8 Total Tests
9 Tests/ 1M pop
10 Population
11 Type: 'state', 'district', 'territory'</code></pre><div class="ide code-starter clearfix"><pre><code>import LessonUtil as Util
data = Util.read_dataset()
print('rows', len(data))

row0 = data[0]
print('cols', len(row0))
print(row0)</code></pre></div><p class="new">Note that EVERY column is a string.  You will need to convert the columns to
 numbers if necessary.</p><h2 id="covid-19-processing-">Covid-19 Processing </h2><p class="new">The goal is to print out the states whose 'Total Cases' is greater than 10% of 
the state's population.</p><p class="new">The final result is a string that looks like the following:</p><pre><code>States: Maine, Hawaii, Vermont,</code></pre><p class="new">Note the spacing and the trailing ',' (it's easier this way)</p><h3 id="covidstates"><code>covid_states</code></h3><p class="new">Define a function named <code>covid_states</code> that does the following:</p><ul><li>has a single parameter whose value is the 'list of lists'</li><li>uses <code>filter</code> to extract the 'rows' whose type is <code>'state'</code> and whose
'Total Cases' is greater than 10% of the state's population</li><li>uses <code>map</code> to extract the name of the state</li><li>uses 'reduce` to build the final output string</li></ul><p class="new">Once that is done the following should work:</p><div class="ide code-starter clearfix"><pre><code>def test_covid():
    import LessonUtil as Util

    ds = Util.read_dataset()
    result = covid_states(ds)
    print(result)</code></pre></div><p class="new">Ignoring comments, you can write the entire function in three lines of code!</p><p class="new">You can confirm your answers by looking at the chart below:
Current statistics <a href="https://www.statista.com/statistics/1109004/coronavirus-covid19-cases-rate-us-americans-by-state/" target="_blank">here</a></p><img alt="covid.png" class="center border2" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/py/funfun/html/covid.png"/><h1>Test and Submit</h1><p>Once you have finished, you can download your code (via <code>ide.tester</code>) and upload that file to Gradescope (find lesson with tag <strong>funfun</strong>).</p><div class="my-4"><pre><code><strong># to list the tests available</strong><br/>print(ide.tester.list_tests())<br/><strong># to perform a specific test</strong><br/>print(ide.tester.test_functionality('name of test'))<br/><strong># to test your code (either works)</strong><br/>print(ide.tester.test_notebook())<br/>print(ide.tester.test_notebook(verbose=True))<br/><strong># to prepare and download your code</strong><br/>ide.tester.download_solution()</code></pre></div><div class="lesson-footer flex bg-gray-200 justify-center"><div class="lesson-footer-card displaycard bg-blue-200 border-t border-gray-400 max-w-2xl rounded overflow-hidden shadow-lg"><div class="px-6 py-4"><div class="title-text text-center font-bold text-xl">Functional Fun</div><p class="text-center text-gray-800 text-xl">higher order functions</p><div class="text-center mt-6 text-xl"><i aria-hidden="true" class="fas fa-tags"></i> any questions on Piazza with <span class="font-bold">funfun</span></div><div class="text-gray-700 text-base"> </div><div></div><div class="text-gray-700 text-base">References and Additional Readings</div><div class="text-xs p-2 border border-solid border-gray-500 bg-gray-300"> <div class="text-gray-700 px-4 m-2">• <!-- --> <a href="https://medium.com/better-programming/lambda-map-and-filter-in-python-4935f248593" target="_blank">https://medium.com/better-programming/lambda-map-and-filter-in-python-4935f248593</a></div></div><div class="flex mt-4 border-t border-solid border-gray-500 justify-around bg-gray-200"><div class="text-gray-700 text-center px-4 m-2 text-sm">D.M. &amp; the 🐍</div><div class="text-gray-700 text-center px-4 m-2 text-sm"><strong>Version:</strong> <!-- -->SP21</div></div><div class="text-gray-700 mt-2 text-center text-sm font-bold">All Rights Reserved Michael Haberman</div><div class="text-gray-700 text-center text-sm">Do not distribute this notebook</div></div></div></div><div> </div><div class="ide code-starter clearfix"><pre><code># print(ide.tester.test_notebook()) 
# print(ide.tester.test_notebook(verbose=True)) 

# once you are ready -- run this 
# ide.tester.download_solution() 
</code></pre></div></div></div></body></html>
<!DOCTYPE html><html lang='en'><head><title>Pandas@the Office</title><meta charset="utf-8"><style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}strong{font-weight:bolder}code{font-family:monospace,monospace;font-size:1em}img{border-style:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}h1,h2,h3,p,pre{margin:0}ul{list-style:none;margin:0;padding:0}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e2e8f0}img{border-style:solid}h1,h2,h3{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}code,pre{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}img{display:block;vertical-align:middle}img{max-width:100%;height:auto}.bg-gray-200{--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.bg-gray-300{--bg-opacity:1;background-color:#e2e8f0;background-color:rgba(226,232,240,var(--bg-opacity))}.bg-blue-200{--bg-opacity:1;background-color:#bee3f8;background-color:rgba(190,227,248,var(--bg-opacity))}.bg-blue-300{--bg-opacity:1;background-color:#90cdf4;background-color:rgba(144,205,244,var(--bg-opacity))}.border-gray-400{--border-opacity:1;border-color:#cbd5e0;border-color:rgba(203,213,224,var(--border-opacity))}.border-gray-500{--border-opacity:1;border-color:#a0aec0;border-color:rgba(160,174,192,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.border-solid{border-style:solid}.border-t{border-top-width:1px}.inline-block{display:inline-block}.flex{display:flex}.justify-center{justify-content:center}.justify-around{justify-content:space-around}.clearfix:after{content:"";display:table;clear:both}.font-serif{font-family:Georgia,Cambria,"Times New Roman",Times,serif}.font-semibold{font-weight:600}.font-bold{font-weight:700}.h-64{height:16rem}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-base{font-size:1rem}.text-xl{font-size:1.25rem}.leading-none{line-height:1}.m-2{margin:.5rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.max-w-sm{max-width:24rem}.max-w-2xl{max-width:42rem}.object-contain{-o-object-fit:contain;object-fit:contain}.overflow-hidden{overflow:hidden}.p-1{padding:.25rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.pl-3{padding-left:.75rem}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}.shadow-inner{box-shadow:inset 0 2px 4px 0 rgba(0,0,0,.06)}.text-left{text-align:left}.text-center{text-align:center}.text-black{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity))}.text-gray-700{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.text-gray-800{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity))}.whitespace-no-wrap{white-space:nowrap}.w-1\/2{width:50%}.w-full{width:100%}.text-tiny{font-size:.5rem!important}body{color:#000!important;font-size:1.25rem!important}.main-content{max-width:900px}.lesson{padding-left:15px!important;padding-right:10px!important;--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.main-content,html{font-family:Arial,Georgia,Verdana,"Times New Roman"!important}.lesson-footer-card,.lesson-overview-card{font-family:"Times New Roman"!important}.lesson-footer{margin-top:50px;margin-top:20px}.lesson ul{list-style-position:inside;list-style-type:none;margin-left:1em}.lesson ul li{padding-left:1em;padding-right:5px}.lesson ul li::before{content:"‚Ä¢";padding-right:5px}span{white-space:nowrap}p.new{padding-top:0;padding-bottom:.5em}p.new+p{padding-top:.5em}h1,h2,h3{font-weight:700;margin-top:.25em!important;margin-bottom:.05em!important;font-family:Georgia,Cambria,"Times New Roman",Times,serif!important}h1{font-size:2em!important;clear:both;color:#000!important}div+h1,h2{margin-top:0!important}h2{margin-top:.5em!important;font-size:1.5em!important;clear:both;color:#8b0000!important}h3{font-size:1.25em!important;clear:both;color:#006400!important}ul{margin-bottom:30px}p.new a{text-decoration:underline}.lesson a{text-decoration:underline;color:#00f}.title-text{font-size:2rem}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.5)}img.center{-o-object-position:center;object-position:center;margin-left:auto;margin-right:auto}img.iw600{height:auto;width:auto;max-width:600px}code{font-size:smaller}pre code{font-size:15px}pre code:not(.line-number){background:#f4f4f4;font-family:monospace;font-size:15px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;touch-action:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;clear:both;border:1px solid #ddd;color:#666;page-break-inside:avoid;display:block;min-width:840px;max-width:840px;overflow:scroll;line-height:1.6;margin-bottom:1.6em;padding:1em 1.5em;-moz-tab-size:2;-o-tab-size:2;tab-size:2;word-wrap:break-word;white-space:pre-wrap;border-left:3px solid #f36d33}div.code-starter>pre code{border-left:3px solid #fdff44!important;background-image:radial-gradient(rgba(0,150,0,.75),#000 120%);color:#fff;font:.9rem Inconsolata,monospace}div.code-starter>pre code::after{content:"\a$_"}</style>
<script src="https://kit.fontawesome.com/7efc4bcee2.js" crossOrigin="anonymous"></script>
<script>
    let stateCheck = setInterval(function(){
      if (document.readyState === 'complete') {
        clearInterval(stateCheck);
        let s1 = document.getElementById('start');
        // console.log('doc is ready', s1);
        if (s1) {
           s1.setAttribute('tabindex', '-1');
           s1.focus(); 
           s1.scrollIntoView({behavior: 'smooth'}); 
           setTimeout(function(){s1.blur()}, 500);
           // console.log('focus set');
        }
      }
    }, 200);
    </script>
</head><body class="lesson"><div class="main-content lesson bg-gray-200 text-black p-1 pl-3 font-serif"><div class="md-inner">
<div id="start" class="section">&nbsp;</div><h1 class="overview"></h1><div class="lesson-overview bg-gray-200 flex justify-center"><div class="text-center px-4 py-2 m-2"><div class="lesson-overview-card displaycard bg-blue-200 max-w-sm rounded overflow-hidden shadow-lg"><div>¬†</div><img alt="Text" class="object-contain h-64 w-full" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/cc/pandas_office/html/cc-sm.png"/><div class="px-6 py-4"><div class="title-text text-center leading-none font-bold text-xl">Pandas@the Office</div><p class="text-center mt-2 text-gray-800 text-xl">Paper Your Way</p><div class="text-gray-700 text-base">¬†</div><div class="text-center mb-3"><span class="inline-block bg-gray-300 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2">#info490</span><span class="inline-block bg-gray-300 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2">#python</span></div><div class="flex border-t border-solid border-gray-500 shadow-inner justify-around bg-blue-300"><div class="text-gray-700 text-center px-4 m-2 text-sm"><span class="whitespace-no-wrap">üêç¬†¬†4 D.S.</span></div><div class="text-gray-700 text-center px-4 m-2 text-sm"><span class="whitespace-no-wrap"><strong>Version:</strong> <!-- -->SP21</span></div></div><div class="text-gray-700 mt-1 text-center text-tiny">All Rights Reserved</div></div></div></div><div class="text-center px-4 py-2 m-2 w-1/2"><div class="displaycard bg-gray-200 max-w-sm rounded overflow-hidden shadow-lg"><div class="px-6 py-4 text-left"><div class="text-center font-bold text-xl">Pandas@the Office<br/><div><span>prerequisites</span><div class="text-center text-xs mb-2">(start only after finishing)</div><p class="max-w-sm text-gray-800 text-sm">‚¶ø <strong>Pandas part 1</strong></p><p class="max-w-sm text-gray-800 text-sm">‚¶ø <strong>Pandas  part 2</strong></p></div></div></div><div class="px-6 py-4 text-left text-gray-800"><div class="text-center font-bold text-xl">Colab Notes</div><p class="max-w-sm text-sm">1. <strong>Copy</strong> this notebook <img alt="copy2drive.png" class="inline-block" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/cc/pandas_office/html/copy2drive.png"/></p><p class="max-w-sm text-sm">2. <strong>Update</strong> the <strong><code>NET_ID</code></strong> in the notebook</p><p class="max-w-sm text-gray-800 text-sm">3. <strong>Hit ‚ñ∂Ô∏è¬†</strong> to install the INFO 490 IDE</p><div class="text-center font-bold text-xl">¬†</div><div class="text-center font-bold text-xl">Jupyter/PyCharm Notes</div><p class="max-w-sm text-gray-800 text-sm text-left">The testing framework does <strong>not work</strong> (at this time) for Jupyter  notebooks or local code development.</p></div></div></div></div><h1 class="section" id="section1">Pandas@the Office</h1><h2 id="paper-your-way">Paper Your Way</h2><img alt="ds1.jpeg" class="center iw600" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/cc/pandas_office/html/ds1.jpeg"/><h1 class="section" id="section2">The Situation</h1><p class="new">You've been hired by a small paper company as their data scientist. The branch manager, 
Michael, isn't too happy with the hire (corporate hired you) and has placed you 
with the human resource team. Your goal is to prove your worth to the branch manager.</p><h1 class="section" id="section3">The Data</h1><p class="new">The following is a small sample of the paper sales from the small company out of Pennsylvania. 
Each sales made during the year records the month, the sales amount, the region, the zip-code, 
the sales person, category and product.</p><pre><code>Month, Region, Zip, Sales Person, Category, Product, Total
Dec,South,15213,Dwight,Paper,Bond-20,1854.95
July,North,15120,Jim,Paper,Bond-40,725.24
Sept,East,15218,Packer,Paper,Bond-30,296.38
Nov,North,15204,Dwight,Paper,Laser-24,1918.63
Feb,South,15214,Jim,Paper,Bond-20,1398.25
Oct,North,15206,Danny,Paper,Bond-30,835.95
Aug,North,15207,Jim,Paper,Card Stock,944.96
Mar,East,15224,Ryan,Paper,Bond-50,2061.28
Dec,East,15222,Michael,Paper,Laser-24,977.42
Oct,East,15224,Dwight,Paper,Bond-40,1810.23
Nov,East,15218,Danny,Copier,S450,1901.46
July,East,15222,Dwight,Paper,Card Stock,1798.76</code></pre><p class="new">The entire dataset can be loaded via the LessonUtil as well:</p><div class="ide code-starter clearfix"><pre><code>import LessonUtil as Util
import pandas as pd

p = Util.path_for_data('dm101s.csv')
df = pd.read_csv(p)
print(df.head())</code></pre></div><p class="new">You can view it <a href="https://raw.githubusercontent.com/NSF-EC/INFO490Assets/master/src/datasets/dunder/dm101s.csv" target="_blank">online</a> as well.</p><h1 class="section" id="section4">Lesson Assignment</h1><p class="new">For this assignment you will use Pandas to do some data analysis of the sales 
made during the year. </p><h2 id="ground-rules">Ground Rules</h2><p class="new">For every question:</p><ul><li>return a Pandas DataFrame or Series or the result of a Pandas expression/operation, unless otherwise noted</li><li>Do NOT create a DataFrame, Series, or any data type to return.</li><li>Always return the result of a Pandas operation (e.g. <code>sum</code>, <code>groupby</code>, etc):</li><li>The entire set of questions can be answered by the material found in the
two lessons on Pandas. There's no need to scour the internet.</li></ul><pre><code>  # GOOD
  return df['some_column'].some_valid_function()
  return df[some_mask].iloc[20]['Total']
  
  # BAD
  return pd.DataFrame( ... )
  
  # UGLY
  return 10.0</code></pre><h2 id="the-questions">THE QUESTIONS</h2><h3 id="question-1-build-the-dataframe--">Question 1: Build the DataFrame.  </h3><p class="new">Finish the implementation of <code>build_dataframe</code>  which does the following:</p><ul><li>creates a Pandas dataframe using resource (a csv file or URL)</li><li>cleans the column names so that all internal and surrounding spaces are removed</li><li>returns the dataframe</li></ul><div class="ide code-starter clearfix"><pre><code>def build_dataframe(resource):
    return None</code></pre></div><h3 id="question-2-returns-the-total-sales-for-the-entire-company-">Question 2: returns the total sales for the entire company </h3><p class="new">The parameter, <code>df</code> is the dataframe created <code>via build_dataframe</code></p><div class="ide code-starter clearfix"><pre><code># already DONE !!!! YES.
def total_sales(df):
    return df['Total'].sum()</code></pre></div><p class="new">Now the following should work:</p><pre><code>p = Util.path_for_data('dm101s.csv')
df = build_dataframe(p)
print(total_sales(df))</code></pre><p class="new">You can also test it using the built-in tester:</p><pre><code>print(ide.tester.test_function(total_sales))</code></pre><h3 id="question-3-">Question 3: </h3><p class="new">return the total sales by Pam (across all months, products, regions)</p><ul><li><code>df</code> is the dataframe created via <code>build_dataframe</code></li><li>remember, you can't return a hardcoded number (e.g. 20.34)</li><li>Pam is a person, not a product</li></ul><div class="ide code-starter clearfix"><pre><code>def pam_sales(df):
    return None</code></pre></div><h3 id="question-4-">Question 4: </h3><p class="new">return an array that contains the set of all the possible products sold.</p><ul><li><code>df</code> is the dataframe created via <code>build_dataframe</code></li><li>do not hard code the answers, get the data from the dataframe</li></ul><div class="ide code-starter clearfix"><pre><code>def all_products(df):
    return None</code></pre></div><h3 id="question-5-">Question 5: </h3><p class="new">return the total for paper sold by Dwight </p><ul><li><code>df</code> is the dataframe created via <code>build_dataframe</code></li></ul><div class="ide code-starter clearfix"><pre><code>def dwight_paper_sales(df):
    return None</code></pre></div><h3 id="question-6-">Question 6: </h3><p class="new">return the total sales by region.</p><ul><li><code>df</code> is the dataframe created via <code>build_dataframe</code></li><li>results must be sorted in descending order</li></ul><div class="ide code-starter clearfix"><pre><code>def sales_by_region(df):
    return None</code></pre></div><p class="new"> 
If you printed the results of <code>sales_by_region</code>, you would get the following:</p><pre><code>Region
East     624208.80
South    266489.36
North    257879.98
West     140642.12</code></pre><h3 id="question-7-">Question 7: </h3><p class="new">return the monthly average for Andy's sales of Bond-20 and Bond-50 paper.</p><ul><li><code>df</code> is the dataframe created via <code>build_dataframe</code></li><li>the average sales should be for all twelve months (not just the months he made sales)</li></ul><div class="ide code-starter clearfix"><pre><code>def andy_bond_sales(df):
    return None</code></pre></div><h3 id="question-8-">Question 8: </h3><p class="new">It is known that Erin actually did all of Andy's December sales. 
Recalculate the same value as in question 7 but remove his December 'sales'</p><ul><li><code>df</code> is the dataframe created via <code>build_dataframe</code></li><li>the average sales should be for all twelve months (not just the months he sold product)</li></ul><div class="ide code-starter clearfix"><pre><code>def andy_bond_sales_adjusted(df):
    return None</code></pre></div><h3 id="question-9-">Question 9: </h3><p class="new">returns the top(n) salespeople based on total sales for the year</p><ul><li><code>df</code> is the dataframe created via <code>build_dataframe</code></li><li><code>topn</code> determines how many of the top results should be included</li><li>the result should be a Pandas Series</li></ul><div class="ide code-starter clearfix"><pre><code>def top_sales_people(df, topn):
    return None</code></pre></div><p class="new">Sample output (topn == 5): (not the actual answer)</p><pre><code>SalesPerson
Danny      231712.62
Michael    131885.57
Karen       84060.05
Andy        47327.09
Pam         41560.36</code></pre><h3 id="question-10-">Question 10: </h3><p class="new">returns a DataFrame that shows the monthly sales for each salesperson. The 
resulting DataFrame is in ascending order (based on sales made)</p><ul><li><code>df</code> is the dataframe created via <code>build_dataframe</code></li></ul><div class="ide code-starter clearfix"><pre><code>def monthly_sales(df):
    return None</code></pre></div><pre><code>Here is an example output:
  Month SalesPerson   Total
0   Feb      Packer  217.98
1   Jan        Andy  297.91
2   Dec         Pam  344.34
3   Oct        Ryan  364.02
4   Mar         Pam  757.28</code></pre><p class="new">So row 0 is the lowest monthly sales. IF every salesperson made at least 
one sale in every month, this report would have #salespeople * 12 rows in it</p><h3 id="question-11-">Question 11: </h3><p class="new">returns the zipcode with the worst total sales for the year</p><ul><li>df is the dataframe created via build_dataframe</li><li>you MUST return a dataframe such that the columns are Zip and Total</li></ul><div class="ide code-starter clearfix"><pre><code>def worst_zip(df):
    return None</code></pre></div><p class="new">the following is what the output should look like: (numbers made up)
<code>Zip     Total
0  12345   6789.01</code></p><h3 id="bonus-question-return-a-full-sales-report-of-the-dataset">BONUS Question: return a full sales report of the dataset</h3><ul><li>df is the dataframe created via build_dataframe</li><li>the returned dataframe (sales report) has its data organized by Category, Product, and SalesPerson.</li><li>for each Category/Product the total sales are organized by the top sales person.</li></ul><pre><code>def sales_report(df):
  return None</code></pre><p class="new">the following is the first 10 rows of the report:</p><pre><code>sf = sales_report(df)
print(sf.head(10))
 
                                 Total
Category Product SalesPerson          
Copier   S100    Danny        10693.73
                 Jim           9365.13
                 Dwight        7565.16
                 Karen         5219.58
                 Pam           4219.27
                 Packer        2154.51
                 Michael       2129.55
         S200    Karen         9815.10
                 Jim           8013.40
                 Danny         7771.97</code></pre><p class="new">This is the preferred format that Michael likes.</p><p class="new">If you reset the index (not required), the report would look like this:</p><pre><code>  Category Product SalesPerson     Total
0   Copier    S100       Danny  10693.73
1   Copier    S100         Jim   9365.13
2   Copier    S100      Dwight   7565.16
3   Copier    S100       Karen   5219.58
4   Copier    S100         Pam   4219.27
5   Copier    S100      Packer   2154.51
6   Copier    S100     Michael   2129.55
.. etc</code></pre><p class="new">The Bonus question will add 10 points to your score (if it passes the tests)</p><h1>Test and Submit</h1><p>Once you have finished, you can download your code (via <code>ide.tester</code>) and upload that file to Gradescope (find lesson with tag <strong>CC-Office</strong>).</p><div class="my-4"><pre><code><strong># to list the tests available</strong><br/>print(ide.tester.list_tests())<br/><strong># to perform a specific test</strong><br/>print(ide.tester.test_functionality('name of test'))<br/><strong># to test your code (either works)</strong><br/>print(ide.tester.test_notebook())<br/>print(ide.tester.test_notebook(verbose=True))<br/><strong># to prepare and download your code</strong><br/>ide.tester.download_solution()</code></pre></div><div class="lesson-footer flex bg-gray-200 justify-center"><div class="lesson-footer-card displaycard bg-blue-200 border-t border-gray-400 max-w-2xl rounded overflow-hidden shadow-lg"><div class="px-6 py-4"><div class="title-text text-center font-bold text-xl">Pandas@the Office</div><p class="text-center text-gray-800 text-xl">Paper Your Way</p><div class="text-center mt-6 text-xl"><i aria-hidden="true" class="fas fa-tags"></i> any questions on Piazza with <span class="font-bold">CC-Office</span></div><div class="text-gray-700 text-base">¬†</div><div></div><div></div><div class="flex mt-4 border-t border-solid border-gray-500 justify-around bg-gray-200"><div class="text-gray-700 text-center px-4 m-2 text-sm">üêç¬†¬†4 D.S.</div><div class="text-gray-700 text-center px-4 m-2 text-sm"><strong>Version:</strong> <!-- -->SP21</div></div><div class="text-gray-700 mt-2 text-center text-sm font-bold">All Rights Reserved Michael Haberman</div><div class="text-gray-700 text-center text-sm">Do not distribute this notebook</div></div></div></div><div>¬†</div><div class="ide code-starter clearfix"><pre><code># print(ide.tester.test_notebook()) 
# print(ide.tester.test_notebook(verbose=True)) 

# once you are ready -- run this 
# ide.tester.download_solution() 
</code></pre></div></div></div></body></html>
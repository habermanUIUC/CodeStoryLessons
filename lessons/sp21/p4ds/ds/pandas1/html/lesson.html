<!DOCTYPE html><html lang='en'><head><title>Pandas, part 1</title><meta charset="utf-8"><style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}strong{font-weight:bolder}code{font-family:monospace,monospace;font-size:1em}img{border-style:none}input{font-family:inherit;font-size:100%;line-height:1.15;margin:0}input{overflow:visible}[type=checkbox]{box-sizing:border-box;padding:0}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}h1,h2,h3,p,pre{margin:0}ul{list-style:none;margin:0;padding:0}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e2e8f0}img{border-style:solid}input:-ms-input-placeholder{color:#a0aec0}input::-ms-input-placeholder{color:#a0aec0}input::-moz-placeholder{color:#a0aec0}h1,h2,h3{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}input{padding:0;line-height:inherit;color:inherit}code,pre{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}img{display:block;vertical-align:middle}img{max-width:100%;height:auto}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.bg-gray-200{--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.bg-gray-300{--bg-opacity:1;background-color:#e2e8f0;background-color:rgba(226,232,240,var(--bg-opacity))}.bg-orange-300{--bg-opacity:1;background-color:#fbd38d;background-color:rgba(251,211,141,var(--bg-opacity))}.bg-green-200{--bg-opacity:1;background-color:#c6f6d5;background-color:rgba(198,246,213,var(--bg-opacity))}.bg-blue-200{--bg-opacity:1;background-color:#bee3f8;background-color:rgba(190,227,248,var(--bg-opacity))}.bg-blue-300{--bg-opacity:1;background-color:#90cdf4;background-color:rgba(144,205,244,var(--bg-opacity))}.border-gray-400{--border-opacity:1;border-color:#cbd5e0;border-color:rgba(203,213,224,var(--border-opacity))}.border-gray-500{--border-opacity:1;border-color:#a0aec0;border-color:rgba(160,174,192,var(--border-opacity))}.border-indigo-500{--border-opacity:1;border-color:#667eea;border-color:rgba(102,126,234,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.border-solid{border-style:solid}.border{border-width:1px}.border-l-2{border-left-width:2px}.border-t{border-top-width:1px}.cursor-pointer{cursor:pointer}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.justify-center{justify-content:center}.justify-around{justify-content:space-around}.float-left{float:left}.clearfix:after{content:"";display:table;clear:both}.font-sans{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}.font-serif{font-family:Georgia,Cambria,"Times New Roman",Times,serif}.font-semibold{font-weight:600}.font-bold{font-weight:700}.h-64{height:16rem}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-base{font-size:1rem}.text-xl{font-size:1.25rem}.leading-none{line-height:1}.leading-normal{line-height:1.5}.m-2{margin:.5rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2{margin-bottom:.5rem}.mr-3{margin-right:.75rem}.mb-3{margin-bottom:.75rem}.mt-4{margin-top:1rem}.mb-4{margin-bottom:1rem}.mt-6{margin-top:1.5rem}.max-w-sm{max-width:24rem}.max-w-2xl{max-width:42rem}.object-contain{-o-object-fit:contain;object-fit:contain}.opacity-0{opacity:0}.overflow-hidden{overflow:hidden}.p-1{padding:.25rem}.p-2{padding:.5rem}.p-3{padding:.75rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.pl-3{padding-left:.75rem}.absolute{position:absolute}.shadow-md{box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06)}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}.shadow-inner{box-shadow:inset 0 2px 4px 0 rgba(0,0,0,.06)}.text-left{text-align:left}.text-center{text-align:center}.text-black{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity))}.text-gray-700{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.text-gray-800{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity))}.whitespace-no-wrap{white-space:nowrap}.w-1\/2{width:50%}.w-2\/3{width:66.666667%}.w-full{width:100%}@media (min-width:768px){.md\:w-2\/3{width:66.666667%}}.text-tiny{font-size:.5rem!important}body{color:#000!important;font-size:1.25rem!important}.main-content{max-width:900px}.lesson{padding-left:15px!important;padding-right:10px!important;--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.main-content,html{font-family:Arial,Georgia,Verdana,"Times New Roman"!important}.lesson-footer-card,.lesson-overview-card{font-family:"Times New Roman"!important}.lesson-footer{margin-top:50px;margin-top:20px}.lesson ul{list-style-position:inside;list-style-type:none;margin-left:1em}.lesson ul li{padding-left:1em;padding-right:5px}.lesson ul li::before{content:"‚Ä¢";padding-right:5px}span{white-space:nowrap}p.new{padding-top:0;padding-bottom:.5em}p.new+p{padding-top:.5em}h1,h2,h3{font-weight:700;margin-top:.25em!important;margin-bottom:.05em!important;font-family:Georgia,Cambria,"Times New Roman",Times,serif!important}h1{font-size:2em!important;clear:both;color:#000!important}div+h1,h2{margin-top:0!important}h2{margin-top:.5em!important;font-size:1.5em!important;clear:both;color:#8b0000!important}h3{font-size:1.25em!important;clear:both;color:#006400!important}ul{margin-bottom:30px}p.new a{text-decoration:underline}.lesson a{text-decoration:underline;color:#00f}.title-text{font-size:2rem}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.5)}img.center{-o-object-position:center;object-position:center;margin-left:auto;margin-right:auto}img.iw600{height:auto;width:auto;max-width:600px}img.iw400{height:auto;width:auto;max-width:400px}code{font-size:smaller}pre code{font-size:15px}pre code:not(.line-number){background:#f4f4f4;font-family:monospace;font-size:15px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;touch-action:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;clear:both;border:1px solid #ddd;color:#666;page-break-inside:avoid;display:block;min-width:840px;max-width:840px;overflow:scroll;line-height:1.6;margin-bottom:1.6em;padding:1em 1.5em;-moz-tab-size:2;-o-tab-size:2;tab-size:2;word-wrap:break-word;white-space:pre-wrap;border-left:3px solid #f36d33}div.code-starter>pre code{border-left:3px solid #fdff44!important;background-image:radial-gradient(rgba(0,150,0,.75),#000 120%);color:#fff;font:.9rem Inconsolata,monospace}div.code-starter>pre code::after{content:"\a$_"}.tab{font-size:1rem;border-color:#8c6728}.tab-content{max-height:0;max-width:100%;transition:max-height .35s}.tab input:checked~.tab-content{max-height:100vh}.tab input:checked+label{padding:1rem;border-left-width:2px;border-color:#6574cd;background-color:#f8fafc;color:#6574cd}.tab label::after{float:right;right:0;top:0;display:block;width:1em;height:1.5em;line-height:1.5;font-size:1rem;text-align:center;transition:all .35s}.tab input[type=checkbox]+label::after{content:"+";font-weight:700;border-width:1px;border-radius:9999px;border-color:#8c6728}.tab input[type=checkbox]:checked+label::after{transform:rotate(315deg);background-color:#6574cd;color:#f8fafc}</style>
<script src="https://kit.fontawesome.com/7efc4bcee2.js" crossOrigin="anonymous"></script>
<script>
    let stateCheck = setInterval(function(){
      if (document.readyState === 'complete') {
        clearInterval(stateCheck);
        let s1 = document.getElementById('start');
        // console.log('doc is ready', s1);
        if (s1) {
           s1.setAttribute('tabindex', '-1');
           s1.focus(); 
           s1.scrollIntoView({behavior: 'smooth'}); 
           setTimeout(function(){s1.blur()}, 500);
           // console.log('focus set');
        }
      }
    }, 200);
    </script>
</head><body class="lesson"><div class="main-content lesson bg-gray-200 text-black p-1 pl-3 font-serif"><div class="md-inner">
<div id="start" class="section">&nbsp;</div><h1 class="overview"></h1><div class="lesson-overview bg-gray-200 flex justify-center"><div class="text-center px-4 py-2 m-2"><div class="lesson-overview-card displaycard bg-blue-200 max-w-sm rounded overflow-hidden shadow-lg"><div>¬†</div><img alt="Text" class="object-contain h-64 w-full" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/ds-sm.png"/><div class="px-6 py-4"><div class="title-text text-center leading-none font-bold text-xl">Pandas, part 1</div><p class="text-center mt-2 text-gray-800 text-xl">Move over Excel</p><div class="text-gray-700 text-base">¬†</div><div class="text-center mb-3"><span class="inline-block bg-gray-300 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2">#info490</span></div><div class="flex border-t border-solid border-gray-500 shadow-inner justify-around bg-blue-300"><div class="text-gray-700 text-center px-4 m-2 text-sm"><span class="whitespace-no-wrap">üêç¬†¬†4 D.S.</span></div><div class="text-gray-700 text-center px-4 m-2 text-sm"><span class="whitespace-no-wrap"><strong>Version:</strong> <!-- -->SP21</span></div></div><div class="text-gray-700 mt-1 text-center text-tiny">All Rights Reserved</div></div></div></div><div class="text-center px-4 py-2 m-2 w-1/2"><div class="displaycard bg-gray-200 max-w-sm rounded overflow-hidden shadow-lg"><div class="px-6 py-4 text-left"><div class="text-center font-bold text-xl">Pandas, part 1<br/><div><span>prerequisites</span><div class="text-center text-xs mb-2">(start only after finishing)</div><p class="max-w-sm text-gray-800 text-sm">‚¶ø <strong>bootcamp</strong></p><p class="max-w-sm text-gray-800 text-sm">‚¶ø <strong>matplotlib (part 1)</strong></p><p class="max-w-sm text-gray-800 text-sm">‚¶ø <strong>numpy parts 1, 2</strong></p></div></div></div><div class="px-6 py-4 text-left text-gray-800"><div class="text-center font-bold text-xl">Colab Notes</div><p class="max-w-sm text-sm">1. <strong>Copy</strong> this notebook <img alt="copy2drive.png" class="inline-block" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/copy2drive.png"/></p><p class="max-w-sm text-sm">2. <strong>Update</strong> the <strong><code>NET_ID</code></strong> in the notebook</p><p class="max-w-sm text-gray-800 text-sm">3. <strong>Hit ‚ñ∂Ô∏è¬†</strong> to install the INFO 490 IDE</p><div class="text-center font-bold text-xl">¬†</div><div class="text-center font-bold text-xl">Jupyter/PyCharm Notes</div><p class="max-w-sm text-gray-800 text-sm text-left">The testing framework does <strong>not work</strong> (at this time) for Jupyter  notebooks or local code development.</p></div></div></div></div><h1 class="section" id="section1">Data Science &amp; üêç: Pandas, part 1 </h1><h2 id="move-over-excel">Move over Excel</h2><img alt="ds1.png" class="float-left mr-3 iw400" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/ds1.png"/><p class="new">The Pandas library is one of the most popular Python libraries for doing data analysis. 
You can start using it by importing the library. It's considered best practice 
to import it as pd:</p><div class="ide code-starter clearfix"><pre><code>import pandas as pd 
print(pd.__version__) 
# Pandas 1.0 was recently released!</code></pre></div><p class="new">Pandas was inspired by R's fundamental data structure, the <code>data.frame</code>. The latest Panda's 
release has two fundamental data structures: the Series (a 'list' of data), and the 
DataFrame (a 'table' of data).  We will focus mostly on the DataFrame. Historically, 
Pandas had a data structure named Panel where it got its name: <strong>Pan</strong>el <strong>Da</strong>ta.</p><p class="new">One of the easiest ways to understand the DataFrame is to think of it as a table 
of data with rows and columns. You can also think of the DataFrame as a way to 
use Python to do everything (and much more) you can do in Excel -- but rather 
than manually selecting rows and columns and entering formulas, you write code 
to do it for you. It's your personal Excel minion.</p><h1 class="section" id="section2">Data Frame Anatomy</h1><p class="new">The parts of a DataFrame are essentially the same as what we would expect. 
Rows are zero index based and columns have labels. We'll look at each of 
these features in this lesson.</p><img alt="ds2.png" class="iw600 center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/ds2.png"/><h2 id="example">üé∂Example</h2><p class="new">Let's start with an Excel spreadsheet and move quickly to Python and Pandas. Here's 
an Excel document that shows some information on different musicians.</p><img alt="ds3.png" class="iw600 mb-4 center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/ds3.png"/><p class="new">You can export the data as a csv file and import it using Pandas:</p><div class="ide code-starter clearfix"><pre><code># this is conventional way to import pandas
import pandas as pd   

import LessonUtil as Util

# read in the same data
df = pd.read_csv(Util.path_for_data('music.csv'))</code></pre></div><p class="new">Note that importing pandas as <code>pd</code> allows you to keep the pandas syntax (keys typed) short 
and sweet. Using <code>pd</code> is the conventional way to import pandas. </p><p class="new">Pandas also supports reading Excel documents directly (skipping the need to export 
the data as <code>.csv</code> formatted data). Pandas can even read the data using the
 URL of a remote resource as well.</p><p class="new">The returned object from <code>read_csv</code> is a Panda DataFrame. It's Panda's 
fundamental data structure. You can think of it as a table of values that you 
can access rows, columns, cells, and subsets of the data.</p><p class="new">To show the contents you can do the following:</p><pre><code># print the first 5 records
print(df.head(5))</code></pre><p class="new">This truncates the data to fit the screen size (you may may 
need to expand your window/width).<br/>You can get all the data via <code>to_string</code>:</p><pre><code># print ALL of it
print(df.to_string())</code></pre><p class="new">One thing you might have noticed is that there is an extra column. That column 
is called the index (and thankfully, it's zero based). Since we didn't tell 
Pandas to create the index explicitly, it's called an implicit index.</p><img alt="ds4.png" class="iw600 center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/ds4.png"/><h2 id="general-information">General Information</h2><p class="new">You can get the number of rows and columns in a DataFrame by using the <code>.shape</code> 
property:</p><div class="ide code-starter clearfix"><pre><code>size = df.shape
rows  = size[0]
cols  = size[1]
print(rows, cols)</code></pre></div><p class="new">The <code>.size</code> property gives you the number of row * columns:</p><pre><code>print(df.size)</code></pre><p class="new">The row and column counts are available using the <code>count</code> method:</p><pre><code>print(df.count(axis='columns'))
print(df.count(axis='rows'))

# Hmm ... 
print(len(df))</code></pre><h2 id="column-cleaning-and-renaming">Column Cleaning and Renaming</h2><p class="new">A majority of analysis using Pandas will be applying a function (or set of 
functions) to some selection (e.g. columns, rows, and subsets) of the data. 
You can change the names of the columns to make selection easier (i.e. less typing).</p><p class="new">(Note if you need to come back to this lesson, you will have to re-execute rename_demo())</p><div class="ide code-starter clearfix"><pre><code># change specific columns 
def rename_demo(df):
    df.rename(columns={
       'age started playing':'asp', 
       'wiki page words': 'wpw',
       'firstname' : 'first',
       'lastname ' : 'last',  # note the space
       'instrument': 'instr'
    }, inplace=True)
    
    return df

df2 = rename_demo(df.copy())
print(df2.head(7))</code></pre></div><p class="new">Our data now looks like this: 
<img alt="ds5.png" class="iw600 center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/ds5.png"/></p><p class="new">Run the following to show how you can also use a function to process the columns
 names:</p><pre><code>df3 = df2.rename(columns=lambda x: 'asp' if x == 'age started playing' else x)
print(df3.head(3))</code></pre><p class="new">This is particularly useful when you need to process the column names that need 
to be cleaned (e.g. remove whitespace, normalize case, etc):</p><h2 id="all-column-changing">All Column Changing</h2><p class="new">You can even use a function to process the columns:</p><pre><code># note the original data has a space in one of it's columns
df3b = df.rename(columns=lambda x: x.strip())
print(df3b.head(7))</code></pre><p class="new">You could just change the headings in the actual data set; however, this is 
usually a bad idea since the data could be coming from another source and you 
don't want to manually change column names (and remember what you did) every 
time the data is refreshed or updated.</p><h2 id="column-types">Column Types</h2><p class="new">Although you usually don't want to program to specific types (you strive to be type agnostic), you can see what Pandas is using to store your data:</p><pre><code>print(df.dtypes)</code></pre><p class="new">You can change the type of a column as well (see the documentation for <code>astype</code>).</p><h1 class="section" id="section3">Selection</h1><p class="new">Selecting columns and rows is incredibly easy. Pandas provides various ways to 
get all the rows of certain columns to all the columns of certain rows (and everything in between).</p><h2 id="selecting-columns">Selecting Columns</h2><p class="new">To get a single column we use the dictionary access notation:</p><div class="ide code-starter clearfix"><pre><code>print(df3['first'])</code></pre></div><p class="new">In this case we are using the column label much like a dictionary key to access 
the column values. Each column is a Panda Series object. </p><p class="new">You can also pass an array of columns to select:</p><pre><code>print(df3[ ['last', 'asp'] ])</code></pre><img alt="ds6.png" class="iw600 center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/ds6.png"/><p class="new">In this case the returned type is a DataFrame.</p><p class="new">You can also use the name of the column directly:</p><pre><code>print(df3.wpw)</code></pre><h2 id="selecting-rows">Selecting Rows</h2><p class="new">We can select rows just as easy. The default is to use integer indices (much 
like a list). The returned type is a DataFrame:</p><pre><code># select the first 2 rows
print(df3[0:2])

# select rows 1,2
print(df3[1:3])</code></pre><h2 id="subsets-with-iloc">Subsets with iloc</h2><p class="new">There are two ways to do DataFrame slicing. One uses integers as indices 
the other uses labels. 
The <code>.iloc</code> property is used with integers indices and its format is the same 
as Python slices.  It is zero based and the upper range number is exclusive (not inclusive) 
just like slices.</p><h2 id="iloc-slicing">iloc slicing</h2><div class="ide code-starter clearfix"><pre><code>def demo_iloc(df):
    # df.iloc[row_selection, column_selection]
    print(df.iloc[ 0:3 , 3:4])
    print(df.iloc[ ::2 , [1,3,5]])
    print(df.iloc[-5:  , 1:4])

demo_iloc(df3)</code></pre></div><p class="new">Note the importance of the comma, it separates row section and 
column selection and it is the cause of visual confusion when 
you see things like this:</p><pre><code>    # add to demo_iloc
    print(df.iloc[:,:])
    print(df.iloc[4:,:])
    print(df.iloc[:,])
    print(df.iloc[:])</code></pre><p class="new">Be sure to understand that syntax, you'll see it a lot in tutorials. Once again 
please try to figure out what will be printed, then run the code (by typing it in!)</p><h2 id="subsets-with-loc">Subsets with loc</h2><p class="new">You can also use the <code>.loc</code> property to do slicing using labels; however the 
range is <strong>inclusive</strong>:</p><div class="ide code-starter clearfix"><pre><code>def demo_loc(df):
    # loc slicing
    # df.loc[row_selection, column_selection]
    print(df.loc[ '1':'2' , 'first':'asp'])

demo_loc(df3)</code></pre></div><p class="new">If there is a default implicit index on a DataFrame, the <code>.loc</code> property can 
also work with numbers for the rows (it uses the default index):</p><pre><code>    # add to demo_loc
    print(df.loc[1:2 , 'first':'asp'])</code></pre><p class="new">The array syntax also works:</p><pre><code>    # add to demo_loc
    print(df.loc[1:5, ["genre", "band"]])</code></pre><p class="new">As does a mixture:</p><pre><code>    # add to demo_loc
    print(df.wpw[1:3])</code></pre><h1 class="section" id="section4">The Index</h1><p class="new">As a reminder, the index is column zero. In most cases you will want an 
explicit index on the Dataframe. It helps both in access and performance if 
the value of the index is unique (so no rows share the same value for the index).</p><div class="ide code-starter clearfix"><pre><code>def create_index(df):
    rc = df.shape[0] # row count
    df['id'] = [str(x+11) for x in range(0, rc)]
    df.set_index('id', inplace=True)
    print(df.head())
    return df

df_i = create_index(df3.copy())</code></pre></div><p class="new">Once you have this index set up, you can use labels for both rows and 
columns with the <code>.loc</code> property:</p><pre><code>print(df_i.loc['11':'17':2 , 'first':'asp'])</code></pre><p class="new">You can even use one of the columns as the index column (once again it's 
best that the values are unique):</p><pre><code>df_i = df3.set_index('first')
print(df_i.head())</code></pre><img alt="ds7.png" class="iw600 center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/ds7.png"/><p class="new">With this index in place, you can use the labels to match for values in the 'first' column:</p><pre><code>print(df_i.loc[ ['john','jon'] , 'last':'asp'])</code></pre><p class="new">Note you can no longer use the index column in the columns selection part:</p><pre><code># this will not work
print(df_i.loc[ ['jon'], ['first','last'] ])

# this will though
print(df_i.loc[ ['jon'], ['last'] ])</code></pre><h1 class="section" id="section5">Boolean Selection (i.e. Filtering)</h1><p class="new">Just like in Numpy (Pandas uses Numpy), you can set up filtering based on a boolean condition:</p><img alt="ds8.png" class="iw600 center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/ds8.png"/><div class="ide code-starter clearfix"><pre><code>plays_guitar   = df3['instr'] == 'guitar'
guitar_players = df3[plays_guitar]
print(guitar_players.head())</code></pre></div><p class="new">You can also combine different boolean filters using the following operators:</p><ul><li><code>&amp;</code> (and)</li><li><code>|</code> (or)</li><li><code>~</code> (not)</li></ul><div class="ide code-starter clearfix"><pre><code>def demo_boolean(df):
    plays_guitar = df['instr'] == 'guitar'
    after_8      = df['asp'] &gt; 8 
    rock         = df['genre'] == 'rock'

    who_am_i = df[plays_guitar &amp; after_8 &amp; ~rock]
    print(who_am_i['last'])
    
demo_boolean(df3)</code></pre></div><h2 id="isin"><code>isin</code></h2><p class="new">In addition, the <code>isin</code> method can be used to help create masks as well:</p><div class="ide code-starter clearfix"><pre><code>def demo_is_in(df):
    gd_player = df['instr'].isin(['guitar', 'drums'])
    print(df[gd_player][ ['first', 'last'] ] )
demo_is_in(df3)</code></pre></div><h1 class="section" id="section6">Functions</h1><p class="new">When you select a column (e.g. <code>df['band']</code>) the returned type is a Pandas Series. 
You can see all the possible functions that Series support 
<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html" target="_blank">here</a>.</p><p class="new">To count the actual contents of the column you can use the <code>value_counts</code> method:</p><div class="ide code-starter clearfix"><pre><code>def demo_series(df):
    print(df['band'].value_counts())
    
    # show those with no value for band as well
    print(df['band'].value_counts(dropna=False))

demo_series(df3)</code></pre></div><p class="new">The Pandas Series also provides a count method.</p><pre><code>    # add to demo_series
    
    # look at the rows
    print(df['instr'])
    print(df['instr'].count())
    
    # look at the values
    print(df['instr'].value_counts())
    # count of the counts 
    print(df['instr'].value_counts().count())</code></pre><p class="new">As with Numpy, Pandas also supports the universal functions (those that 
operate on an element by element basis):</p><pre><code>    pct = df['wpw'] / df['asp']
    print(pct)</code></pre><h1 class="section" id="section7">Aggregation</h1><p class="new">The following aggregation functions are available on any series of data (these 
work on numerical data columns). There will be a separate lesson on descriptive 
statistics including skewness!</p><img alt="ds9.png" class="iw400 mb-4 center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/p4ds/ds/pandas1/html/ds9.png"/><p class="new">So in order to sum up a column of values, it can easily be done:</p><div class="ide code-starter clearfix"><pre><code>def demo_agg(df):
    print(df['wpw'].sum())
    
demo_agg(df3)</code></pre></div><p class="new">You can also get the unique values of a column:</p><pre><code>    print(df['genre'].unique())</code></pre><p class="new">The thing to remember is to know with which Pandas datatype you are working. 
You can then easily find what functions work with the respective type.</p><h1 class="section" id="section8">Working with Strings</h1><p class="new">We saw earlier that dealing with strings and dates in Numpy is not very straightforward. 
With Pandas, each value has a <code>.str</code> property with which you can use to perform 
string functions.  For example, a few of the artists have a trailing space in their 
first name. You can remove those easily using the <code>.str</code> property. However, we 
will need to reset the index so we can work on the 'first' column:</p><div class="ide code-starter clearfix"><pre><code>def demo_str(df):
    df = df.reset_index()
    print(df['first'])

demo_str(df3)</code></pre></div><p class="new">Now we can go ahead and process the data in the 'first' column  (note we assign 
the same column to the result of the function call):</p><pre><code>    # add to demo_str
    df['first'] = df['first'].str.strip()
    print(df['first'])</code></pre><p class="new">You can also use the same <code>.str</code> property on column names to clean them up:</p><div class="ide code-starter clearfix"><pre><code>def demo_clean(df):
    print('BEFORE', df.columns)
    df.columns = df.columns.str.strip()
    print('AFTER', df.columns)
demo_clean(df.copy())</code></pre></div><p class="new">The same property can be used for other string functions (e.g. <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.str.len.html" target="_blank"><code>contains</code> and <code>len</code></a>)</p><div class="ide code-starter clearfix"><pre><code>def demo_str_mask(df):
    mask = df['first'].str.contains('on')
    print(df[mask])
    print(df[mask]['first'].str.len())

    mask = df['first'].str.contains('tom|jon')
    print(df[mask])

demo_str_mask(df3)</code></pre></div><h1 class="section" id="section9">Dealing with Dates </h1><p class="new">In order to show how to work with dates, let's add a column to our data set 
that represents the birthday of the artist:</p><div class="ide code-starter clearfix"><pre><code>def demo_dates(df):
    import LessonUtil as Util
    df['birthday'] = pd.Series(Util.generate_dates(df.shape[0]))
    print(df.head())

    # Even though the birthday field is a string/object, 
    # we can easily convert this to a date object:
    df['birthday'] = pd.Series(Util.generate_dates(df.shape[0]))
    df['birthday'] = pd.to_datetime(df['birthday'])

    print(df['birthday'].dtypes)

demo_dates(df3.copy())</code></pre></div><p class="new">The 'birthday' field is now a datetime object. With that you can use the <code>dt</code> 
field (short for datetime properties) to access things like <code>day, hour, month, dayofweek, year</code> etc.<br/>See the references at the end of this lesson.</p><pre><code>    # add to demo_dates
    df['month'] = df['birthday'].dt.month
    is_early = df['month'].isin([1,2,3])
    print(df[is_early][ ['first', 'last', 'birthday'] ])</code></pre><h1 class="section" id="section10">Column Updates</h1><h2 id="creating-columns">Creating Columns</h2><p class="new">The above example also demonstrates how easy it is to create new columns. In 
combination with the above example of using a universal function, the output 
can easily be assigned to a new column:</p><div class="ide code-starter clearfix"><pre><code>def demo_new_column(df):
    df['pct'] = df['wpw'] / df['asp']
    print(df[ ['first', 'last', 'asp', 'pct'] ])
demo_new_column(df3)</code></pre></div><h2 id="dropping-columns">Dropping Columns</h2><p class="new">You can also remove columns from a dataframe quickly by using the drop method:</p><div class="ide code-starter clearfix"><pre><code>def demo_drop(df):
    df2 = df.drop(columns=['asp', 'wpw'])
    print(df2.head())
    
demo_drop(df3)</code></pre></div><p class="new">There's so much more. But for now, we will take a break before moving on to Part II 
which discusses grouping among other topics.</p><div class="font-sans container mt-1 mb-4 "><p>üéóBefore you go, you should <strong>know</strong>:</p><div class="w-2/3 md:w-2/3"><div class="shadow-md"><div class="tab overflow-hidden border-t bg-green-200"><input class="absolute opacity-0" id="tab-multi-4" name="tabs" type="checkbox"/><label class="block p-3 leading-normal cursor-pointer" for="tab-multi-4"><span> how to read in a csv file </span></label><div class="tab-content overflow-hidden border-l-2 bg-orange-300 border-indigo-500 leading-normal"><p class="p-3">No Answer</p></div></div><div class="tab overflow-hidden border-t bg-green-200"><input class="absolute opacity-0" id="tab-multi-5" name="tabs" type="checkbox"/><label class="block p-3 leading-normal cursor-pointer" for="tab-multi-5"><span> how to select rows </span></label><div class="tab-content overflow-hidden border-l-2 bg-orange-300 border-indigo-500 leading-normal"><p class="p-3">No Answer</p></div></div><div class="tab overflow-hidden border-t bg-green-200"><input class="absolute opacity-0" id="tab-multi-6" name="tabs" type="checkbox"/><label class="block p-3 leading-normal cursor-pointer" for="tab-multi-6"><span> how to select columns </span></label><div class="tab-content overflow-hidden border-l-2 bg-orange-300 border-indigo-500 leading-normal"><p class="p-3">No Answer</p></div></div><div class="tab overflow-hidden border-t bg-green-200"><input class="absolute opacity-0" id="tab-multi-7" name="tabs" type="checkbox"/><label class="block p-3 leading-normal cursor-pointer" for="tab-multi-7"><span> how to create columns </span></label><div class="tab-content overflow-hidden border-l-2 bg-orange-300 border-indigo-500 leading-normal"><p class="p-3">No Answer</p></div></div></div></div></div><h1 class="section" id="section11">Lesson Assignment</h1><p class="new">The lesson comes with its own dataset, <code>data.csv</code>. It is the amount spent on 
various merchants. You will use Pandas to analyize the data.</p><h2 id="q0-">q0: </h2><h3 id="find-the-total-amount-spent-on-all-merchants">Find the total amount spent on all merchants.</h3><p class="new">Answer: already done for you!</p><div class="ide code-starter clearfix"><pre><code>def q0(df):
    total = df['Total'].sum()
    return total</code></pre></div><h3 id="testing-q0">Testing q0</h3><p class="new">In order to get a feel for the result of each stage, just print each step:</p><pre><code>    # inside q0
    series = df['Total']
    print(series)
    total = series.sum()
    print(total)</code></pre><p class="new">You can test all the functions using the <code>RestaurantTester</code></p><pre><code>import LessonUtil as Util
tester = Util.RestaurantTester()
print(tester.test_question(q0))

# or use the dataframe directly
p = Util.path_for_data('data.csv')
df = pd.read_csv(p, delimiter=';')
print(q0(df))</code></pre><h2 id="q1-">q1: </h2><h3 id="how-many-transactions-were-on-restaurants">How many transactions were on Restaurants?</h3><div class="ide code-starter clearfix"><pre><code>def q1(df):
    return 0</code></pre></div><h2 id="q2-">q2: </h2><h3 id="find-the-total-spent-on-restaurants">Find the total spent on Restaurants</h3><div class="ide code-starter clearfix"><pre><code>def q2(df):
    return 0</code></pre></div><h2 id="q3-">q3: </h2><h3 id="how-much-was-spent-on-taxes-for-groceries">How much was spent on taxes for Groceries?</h3><div class="ide code-starter clearfix"><pre><code>def q3(df):
    return 0</code></pre></div><h2 id="q4-">q4: </h2><h3 id="what-was-the-mean-ie-average-of-all-transactions-whose-total-was-under-3-00">What was the mean (i.e. average) of all transactions whose total was under 3 .00?</h3><div class="ide code-starter clearfix"><pre><code>def q4(df):
    return 0</code></pre></div><h2 id="q5-">q5: </h2><h3 id="what-is-the-sum-of-price-on-transactions-where-price-was-a-whole-dollar-amount-ie-cents-is-0-">What is the sum of price on transactions where price was a whole dollar amount (i.e. cents is 0) ?</h3><div class="ide code-starter clearfix"><pre><code>def q5(df):
    return 0</code></pre></div><h2 id="q6-">q6: </h2><h3 id="how-much-was-spent-total-on-merchants-whose-name-is-less-than-7-characters-long">How much was spent total on Merchants whose name is less than 7 characters long?</h3><div class="ide code-starter clearfix"><pre><code>def q6(df):
    return 0</code></pre></div><h2 id="q7-">q7: </h2><h3 id="total-number-of-transactions-where-the-merchants-name-had-the-word-cafe-in-it">Total number of transactions where the Merchant's name had the word 'Caf√©' in it?</h3><div class="ide code-starter clearfix"><pre><code>def q7(df):
    return 0</code></pre></div><h2 id="q8-">q8: </h2><h3 id="how-many-merchants-have-the-word-cafe-in-them-ie-unique-set-merchants">How many Merchants have the word 'Caf√©' in them? (i.e. unique set Merchants)?</h3><div class="ide code-starter clearfix"><pre><code>def q8(df):
    return 0</code></pre></div><h2 id="extra-credit">Extra Credit:</h2><h2 id="q9-">q9: </h2><h3 id="how-much-was-spent-in-total-during-the-month-of-january">How much was spent in total during the month of January?</h3><div class="ide code-starter clearfix"><pre><code>def q9(df):
    return 0</code></pre></div><h2 id="q10-">q10: </h2><h3 id="how-much-was-spent-on-technology-during-the-month-of-february-">How much was spent on Technology during the month of February ?</h3><div class="ide code-starter clearfix"><pre><code>def q10(df):
    return 0</code></pre></div><p class="new">Hints:</p><ul><li>If you find yourself writing loops or using iteration, you should re-think your solution.</li><li>All of these answers can be solved using only Pandas.</li></ul><h1>Test and Submit</h1><p>Once you have finished, you can download your code (via <code>ide.tester</code>) and upload that file to Gradescope (find lesson with tag <strong>DS-Pandas1</strong>).</p><div class="my-4"><pre><code><strong># to list the tests available</strong><br/>print(ide.tester.list_tests())<br/><strong># to perform a specific test</strong><br/>print(ide.tester.test_functionality('name of test'))<br/><strong># to test your code (either works)</strong><br/>print(ide.tester.test_notebook())<br/>print(ide.tester.test_notebook(verbose=True))<br/><strong># to prepare and download your code</strong><br/>ide.tester.download_solution()</code></pre></div><div class="lesson-footer flex bg-gray-200 justify-center"><div class="lesson-footer-card displaycard bg-blue-200 border-t border-gray-400 max-w-2xl rounded overflow-hidden shadow-lg"><div class="px-6 py-4"><div class="title-text text-center font-bold text-xl">Pandas, part 1</div><p class="text-center text-gray-800 text-xl">Move over Excel</p><div class="text-center mt-6 text-xl"><i aria-hidden="true" class="fas fa-tags"></i> any questions on Piazza with <span class="font-bold">DS-Pandas1</span></div><div class="text-gray-700 text-base">¬†</div><div></div><div class="text-gray-700 text-base">References and Additional Readings</div><div class="text-xs p-2 border border-solid border-gray-500 bg-gray-300"> <div class="text-gray-700 px-4 m-2"><span>¬†</span> <strong>Cheat Sheets</strong></div><div class="text-gray-700 px-4 m-2">‚Ä¢ <!-- --> <a href="https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf" target="_blank">https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf</a></div><div class="text-gray-700 px-4 m-2"><span>¬†</span> <strong>Documentation</strong></div><div class="text-gray-700 px-4 m-2">‚Ä¢ <!-- --> <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html" target="_blank">https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html</a></div><div class="text-gray-700 px-4 m-2">‚Ä¢ <!-- --> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html" target="_blank">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html</a></div><div class="text-gray-700 px-4 m-2">‚Ä¢ <!-- --> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.dt.html" target="_blank">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.dt.html</a></div><div class="text-gray-700 px-4 m-2">‚Ä¢ <!-- --> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/arrays.html?highlight=datetime%20properties#api-arrays-datetime" target="_blank">https://pandas.pydata.org/pandas-docs/stable/reference/arrays.html?highlight=datetime%20properties#api-arrays-datetime</a></div><div class="text-gray-700 px-4 m-2">‚Ä¢ <!-- --> <a href="https://pandas.pydata.org/pandas-docs/stable/whatsnew/v1.0.0.html" target="_blank">https://pandas.pydata.org/pandas-docs/stable/whatsnew/v1.0.0.html</a></div></div><div class="flex mt-4 border-t border-solid border-gray-500 justify-around bg-gray-200"><div class="text-gray-700 text-center px-4 m-2 text-sm">üêç¬†¬†4 D.S.</div><div class="text-gray-700 text-center px-4 m-2 text-sm"><strong>Version:</strong> <!-- -->SP21</div></div><div class="text-gray-700 mt-2 text-center text-sm font-bold">All Rights Reserved Michael Haberman</div><div class="text-gray-700 text-center text-sm">Do not distribute this notebook</div></div></div></div><div>¬†</div><div class="ide code-starter clearfix"><pre><code># print(ide.tester.test_notebook()) 
# print(ide.tester.test_notebook(verbose=True)) 

# once you are ready -- run this 
# ide.tester.download_solution() 
</code></pre></div></div></div></body></html>
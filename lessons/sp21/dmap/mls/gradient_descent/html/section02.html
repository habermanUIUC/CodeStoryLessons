<!DOCTYPE html><html lang='en'><head><title>Gradient Descent</title><meta charset="utf-8"><style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}pre{font-family:monospace,monospace;font-size:1em}strong{font-weight:bolder}code{font-family:monospace,monospace;font-size:1em}img{border-style:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}h1,h2,h3,h4,p,pre{margin:0}ul{list-style:none;margin:0;padding:0}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e2e8f0}img{border-style:solid}h1,h2,h3,h4{font-size:inherit;font-weight:inherit}code,pre{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}img{display:block;vertical-align:middle}img{max-width:100%;height:auto}.bg-gray-200{--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.bg-gray-300{--bg-opacity:1;background-color:#e2e8f0;background-color:rgba(226,232,240,var(--bg-opacity))}.bg-blue-200{--bg-opacity:1;background-color:#bee3f8;background-color:rgba(190,227,248,var(--bg-opacity))}.bg-blue-300{--bg-opacity:1;background-color:#90cdf4;background-color:rgba(144,205,244,var(--bg-opacity))}.border-gray-400{--border-opacity:1;border-color:#cbd5e0;border-color:rgba(203,213,224,var(--border-opacity))}.border-gray-500{--border-opacity:1;border-color:#a0aec0;border-color:rgba(160,174,192,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.border-solid{border-style:solid}.border{border-width:1px}.border-t{border-top-width:1px}.inline-block{display:inline-block}.flex{display:flex}.justify-center{justify-content:center}.justify-around{justify-content:space-around}.float-left{float:left}.clearfix:after{content:"";display:table;clear:both}.clear-both{clear:both}.font-serif{font-family:Georgia,Cambria,"Times New Roman",Times,serif}.font-semibold{font-weight:600}.font-bold{font-weight:700}.h-64{height:16rem}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-base{font-size:1rem}.text-xl{font-size:1.25rem}.leading-none{line-height:1}.m-2{margin:.5rem}.m-4{margin:1rem}.my-1{margin-top:.25rem;margin-bottom:.25rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2{margin-bottom:.5rem}.mr-3{margin-right:.75rem}.mb-3{margin-bottom:.75rem}.mt-4{margin-top:1rem}.mb-4{margin-bottom:1rem}.mt-6{margin-top:1.5rem}.max-w-sm{max-width:24rem}.max-w-2xl{max-width:42rem}.object-contain{-o-object-fit:contain;object-fit:contain}.overflow-hidden{overflow:hidden}.p-1{padding:.25rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.pl-3{padding-left:.75rem}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}.shadow-inner{box-shadow:inset 0 2px 4px 0 rgba(0,0,0,.06)}.text-left{text-align:left}.text-center{text-align:center}.text-black{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity))}.text-gray-700{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.text-gray-800{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity))}.text-red-700{--text-opacity:1;color:#c53030;color:rgba(197,48,48,var(--text-opacity))}.whitespace-no-wrap{white-space:nowrap}.w-1\/2{width:50%}.w-full{width:100%}.text-tiny{font-size:.5rem!important}body{color:#000!important;font-size:1.25rem!important}.main-content{max-width:900px}.lesson{padding-left:15px!important;padding-right:10px!important;--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.main-content,html{font-family:Arial,Georgia,Verdana,"Times New Roman"!important}.lesson-footer-card,.lesson-overview-card{font-family:"Times New Roman"!important}.lesson-footer{margin-top:50px;margin-top:20px}.lesson ul{list-style-position:inside;list-style-type:none;margin-left:1em}.lesson ul li{padding-left:1em;padding-right:5px}.lesson ul li::before{content:"â€¢";padding-right:5px}span{white-space:nowrap}p.new{padding-top:0;padding-bottom:.5em}p.new+p{padding-top:.5em}h1,h2,h3,h4{font-weight:700;margin-top:.25em!important;margin-bottom:.05em!important;font-family:Georgia,Cambria,"Times New Roman",Times,serif!important}h1{font-size:2em!important;clear:both;color:#000!important}div+h1,h2{margin-top:0!important}h2{margin-top:.5em!important;font-size:1.5em!important;clear:both;color:#8b0000!important}h3{font-size:1.25em!important;clear:both;color:#006400!important}h4{font-size:1em!important;clear:both;color:#00008b!important}ul{margin-bottom:30px}.title-text{font-size:2rem}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.5)}img.formula-block{margin-left:auto;margin-right:auto;margin-top:.25rem;margin-bottom:.75rem}img.formula-inline{margin-top:.25rem;margin-bottom:.25rem}img.center{-o-object-position:center;object-position:center;margin-left:auto;margin-right:auto}img.border{border:1px solid #021a40;margin-top:.5rem;margin-bottom:.75rem}img.iw600{height:auto;width:auto;max-width:600px}img.iw400{height:auto;width:auto;max-width:400px}img.iw200{height:auto;width:auto;max-width:200px}code{font-size:smaller}pre code{font-size:15px}pre code:not(.line-number){background:#f4f4f4;font-family:monospace;font-size:15px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;touch-action:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;clear:both;border:1px solid #ddd;color:#666;page-break-inside:avoid;display:block;min-width:840px;max-width:840px;overflow:scroll;line-height:1.6;margin-bottom:1.6em;padding:1em 1.5em;-moz-tab-size:2;-o-tab-size:2;tab-size:2;word-wrap:break-word;white-space:pre-wrap;border-left:3px solid #f36d33}div.code-starter>pre code{border-left:3px solid #fdff44!important;background-image:radial-gradient(rgba(0,150,0,.75),#000 120%);color:#fff;font:.9rem Inconsolata,monospace}div.code-starter>pre code::after{content:"\a$_"}</style>
<script src="https://kit.fontawesome.com/7efc4bcee2.js" crossOrigin="anonymous"></script>
<script>
    let stateCheck = setInterval(function(){
      if (document.readyState === 'complete') {
        clearInterval(stateCheck);
        let s1 = document.getElementById('start');
        // console.log('doc is ready', s1);
        if (s1) {
           s1.setAttribute('tabindex', '-1');
           s1.focus(); 
           s1.scrollIntoView({behavior: 'smooth'}); 
           setTimeout(function(){s1.blur()}, 500);
           // console.log('focus set');
        }
      }
    }, 200);
    </script>
</head><body class="lesson"><div class="main-content lesson bg-gray-200 text-black p-1 pl-3 font-serif"><div class="md-inner">
<div id="start" class="section">&nbsp;</div><h1 class="section" id="section2">Calculus, calculus! </h1><h2 id="wherefore-art-thou-calculus-">wherefore art thou calculus? </h2><img alt="calculus.png" class="iw200 float-left mr-3 mb-4" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/mls/gradient_descent/html/calculus.png"/><p class="new">In order to understand the machinery behind GD, we need to peak back into
 our calculus books. If you never had calculus, fear not. Just be open to
  learning the reasons why we need it. Understanding the concepts are more
   important than being adroit at the mechanics.</p><p class="new">Hopefully, you are now comfortable with the concept of a line having a <em>slope</em>. 
 It's simply the change in y divided by its change in x:</p><img alt="math?math=%5CLarge%20slope%20%3D%20%5Cfrac%7B%5CDelta%20y%7D%7B%5CDelta%20x%7D" class=" formula-block" src="https://render.githubusercontent.com/render/math?math=%5CLarge%20slope%20%3D%20%5Cfrac%7B%5CDelta%20y%7D%7B%5CDelta%20x%7D"/><h2 id="magnitude">Magnitude</h2><p class="new"> The slope's <strong>magnitude</strong> tells you how fast the line is changing (a slope of
  zero means it's not changing). </p><h2 id="direction">Direction</h2><p class="new">The <strong>direction</strong> of the change is based on its sign:
<img alt="slopes.png" class="border center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/mls/gradient_descent/html/slopes.png"/></p><p class="new"> Gradient descent loves the negative slope -- it communicates the idea that
  we are moving downward (we can minimize our loss even further).</p><p class="new">For a slope to be negative means either:</p><ul><li>a positive step in the x direction results in a negative change in y</li><li>a negative step in the x direction results in a positive change in y</li></ul><p class="new">By definition, a line's slope is constant.  Calculate it once, and you are done.
  However, for non-linear functions it's not as simple.  But calculus
   provides us with a few tricks (i.e. <em>methods and techniques</em>) to make it
    manageable.</p><h2 id="back-to-the-slopes">Back to the slopes</h2><h3 id="the-tangent-trick-">The Tangent Trick </h3><p class="new">The following non-linear graph is the MSE vs w0 graph we created in the
 linear regression lesson. The MSE value is 258.32 when <code>w0</code> is -8.16. 
 And the number shown (<span class="text-red-700">-30.95</span>) is the <em>slope</em> 
 of that curve at the point (-8.16, 258.32).</p><img alt="mseGraph.png" class="border center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/mls/gradient_descent/html/mseGraph.png"/><p class="new"> How do get that value (<span class="text-red-700">-30.95</span>)? </p><p class="new"> Well if you zoom way into that graph, the 'curve' goes away (like seeing a 
 flat horizon on a spherical earth). We can draw a new line (called the tangent line) that
    just touches the curve near the point we are interested in:</p><img alt="zoom.png" class="border center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/mls/gradient_descent/html/zoom.png"/><p class="new">Note that the orange line (the tangent line) is essentially parallel to the
 curve at the point shown. And we know how to measure the slope of a line.</p><p class="new">We can now measure the â–³ y (-50) for a positive â–³ x (1.6) (we can get those
 values by just selecting two different points). </p><img alt="zoom2.png" class="border center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/mls/gradient_descent/html/zoom2.png"/><h3 id="slopes-are-a-changin">Slopes are a changin'</h3><p class="new">In our simple line equation, <img alt="math?math=%5Clarge%20f(x)%20%3D%20w_0%20%2B%20w_1x" class="my-1 formula-inline" src="https://render.githubusercontent.com/render/math?math=%5Clarge%20f(x)%20%3D%20w_0%20%2B%20w_1x" style="display:inline-block"/>,  <code>w1</code> is the slope. 
The slope tells us how much the line is changing at that point. In the case
 of a simple line, the output (y) always changes by the slope for a single
  step in <code>x</code> (note that value of <code>w0</code> does not affect the result). </p><p class="new">The following graph shows the tangent line (representing the slope of the
 curve) at various selected points. Note what happens when and where the
  tangent line becomes horizontal.
<img alt="tangents.gif" class="border center" src="https://raw.githubusercontent.com/habermanUIUC/CodeStoryLessons/main/lessons/dmap/mls/gradient_descent/html/tangents.gif"/></p><p class="new">It's now clear that when the MSE is at its lowest (<code>w0 = 7.13</code>), the 
slope of the tangent line is zero!  That's exactly what we need. We could pick points on the
  curve, measure the slope (using the tangent line) and decide how to pick
   the next point to try (until we have a zero slope). </p><p class="new">   But we can do even better.</p><h3 id="the-derivative-trick-">The Derivative Trick </h3><p class="new">If you know the function that is responsible for the curve, you can find it's
 derivative (and you know calculus). The derivative is just another function 
 that gives you the slope at a point.  </p><p class="new">Finding the derivative of a function is the specialty of differential calculus -- 
it teaches one how to find derivatives. You don't have to be an expert, but 
you should know the terminology.</p><p class="new">Rather than figuring out the necessary math to draw a line tangent to a curve, we can
    simply ask the derivative function for the value.  When the derivative is zero, we
     are at the minimum for the curve.</p><h2 id="summarys-slope">Summary's Slope</h2><p class="new">Here's what gradient descent is trying to do:  </p><p class="new">You have a function (called the loss function) you want to know where
 that function is at a minimum (i.e. you want to minimize it). For linear
  regression, we use the MSE function. Using calculus you find it's derivative 
  function (or simply derivative).  </p><p class="new">Gradient descent will pick a random point (a guess), ask for it's derivative (i.e. the slope) 
  at that value. If the slope is <em>negative</em> it knows the guess needs to be bigger. 
  If the slope (i.e. derivative) is <em>positive</em>, it knows it needs to subtract 
  a bit from the guess. When the slope is near zero (or at zero), it knows it has 
  found the value(s) where the loss function is minimized. </p><p class="new">That's it in a ðŸ¥œ.  There's a lot more details to fill in.  But here's an outline of
using gradient descent (version 1.0) to find the best value for <code>w0</code>:</p><pre><code>     w0 = pick a random value
     while not finished:
         slope = get_slope_from_derivative(w0)
         if slope &lt; 0:
             # increase our guess
             w0 += a small amount
         elif slope &gt; 0:
             # decrease our guess
             w0 -= a small amount
         else:
             w0 is PERFECT</code></pre></div></div></body></html>
<!DOCTYPE html><html lang='en'><head><title>Data Normalization (part 1)</title><meta charset="utf-8"><style>/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}strong{font-weight:bolder}code{font-family:monospace,monospace;font-size:1em}img{border-style:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}blockquote,h1,h2,h3,h4,p,pre{margin:0}ul{list-style:none;margin:0;padding:0}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e2e8f0}img{border-style:solid}h1,h2,h3,h4{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}code,pre{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}img{display:block;vertical-align:middle}img{max-width:100%;height:auto}.bg-gray-200{--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.bg-gray-300{--bg-opacity:1;background-color:#e2e8f0;background-color:rgba(226,232,240,var(--bg-opacity))}.bg-blue-200{--bg-opacity:1;background-color:#bee3f8;background-color:rgba(190,227,248,var(--bg-opacity))}.bg-blue-300{--bg-opacity:1;background-color:#90cdf4;background-color:rgba(144,205,244,var(--bg-opacity))}.border-gray-400{--border-opacity:1;border-color:#cbd5e0;border-color:rgba(203,213,224,var(--border-opacity))}.border-gray-500{--border-opacity:1;border-color:#a0aec0;border-color:rgba(160,174,192,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.border-solid{border-style:solid}.border{border-width:1px}.border-t{border-top-width:1px}.inline-block{display:inline-block}.flex{display:flex}.justify-center{justify-content:center}.justify-around{justify-content:space-around}.float-left{float:left}.clearfix:after{content:"";display:table;clear:both}.font-serif{font-family:Georgia,Cambria,"Times New Roman",Times,serif}.font-semibold{font-weight:600}.font-bold{font-weight:700}.h-64{height:16rem}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-base{font-size:1rem}.text-xl{font-size:1.25rem}.leading-none{line-height:1}.m-2{margin:.5rem}.my-1{margin-top:.25rem;margin-bottom:.25rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2{margin-bottom:.5rem}.mr-3{margin-right:.75rem}.mb-3{margin-bottom:.75rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.max-w-sm{max-width:24rem}.max-w-2xl{max-width:42rem}.object-contain{-o-object-fit:contain;object-fit:contain}.overflow-hidden{overflow:hidden}.p-1{padding:.25rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.pl-3{padding-left:.75rem}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05)}.shadow-inner{box-shadow:inset 0 2px 4px 0 rgba(0,0,0,.06)}.text-left{text-align:left}.text-center{text-align:center}.text-black{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity))}.text-gray-700{--text-opacity:1;color:#4a5568;color:rgba(74,85,104,var(--text-opacity))}.text-gray-800{--text-opacity:1;color:#2d3748;color:rgba(45,55,72,var(--text-opacity))}.whitespace-no-wrap{white-space:nowrap}.w-1\/2{width:50%}.w-full{width:100%}.text-tiny{font-size:.5rem!important}body{color:#000!important;font-size:1.25rem!important}.main-content{max-width:900px}.lesson{padding-left:15px!important;padding-right:10px!important;--bg-opacity:1;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity))}.main-content,html{font-family:Arial,Georgia,Verdana,"Times New Roman"!important}.lesson-footer-card,.lesson-overview-card{font-family:"Times New Roman"!important}blockquote em:first-child{font-family:Times!important;font-size:1.35em;margin-right:10px}blockquote em:first-child:after{content:":"}.lesson-footer{margin-top:50px;margin-top:20px}.lesson ul{list-style-position:inside;list-style-type:none;margin-left:1em}.lesson ul li{padding-left:1em;padding-right:5px}.lesson ul li::before{content:"â€¢";padding-right:5px}span{white-space:nowrap}p.new{padding-top:0;padding-bottom:.5em}p.new+p{padding-top:.5em}h1,h2,h3,h4{font-weight:700;margin-top:.25em!important;margin-bottom:.05em!important;font-family:Georgia,Cambria,"Times New Roman",Times,serif!important}h1{font-size:2em!important;clear:both;color:#000!important}div+h1,h2{margin-top:0!important}h2{margin-top:.5em!important;font-size:1.5em!important;clear:both;color:#8b0000!important}h3{font-size:1.25em!important;clear:both;color:#006400!important}h4{font-size:1em!important;clear:both;color:#00008b!important}ul{margin-bottom:30px}p.new a{text-decoration:underline}.lesson a{text-decoration:underline;color:#00f}.title-text{font-size:2rem}blockquote{font-size:1em;background:#f9f9f9;border-left:10px solid #ccc;margin:.5em 10px;padding:.5em 10px;border-left-color:#ffcd69;border-right-color:#f6ba59;quotes:"\201C""\201D""\2018""\2019"}blockquote:before{color:#ccc;content:open-quote;font-size:4em;line-height:.1em;margin-right:.25em;vertical-align:-.4em}blockquote:after{color:#ccc;content:no-close-quote}blockquote p{display:inline}.shadow-lg{box-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.5)}img.formula-block{margin-left:auto;margin-right:auto;margin-top:.25rem;margin-bottom:.75rem}img.formula-inline{margin-top:.25rem;margin-bottom:.25rem}img.center{-o-object-position:center;object-position:center;margin-left:auto;margin-right:auto}img.border{border:1px solid #021a40;margin-top:.5rem;margin-bottom:.75rem}img.iw400{height:auto;width:auto;max-width:400px}img.iw500{height:auto;width:auto;max-width:500px}img.iw300{height:auto;width:auto;max-width:300px}code{font-size:smaller}pre code{font-size:15px}pre code:not(.line-number){background:#f4f4f4;font-family:monospace;font-size:15px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;touch-action:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;clear:both;border:1px solid #ddd;color:#666;page-break-inside:avoid;display:block;min-width:840px;max-width:840px;overflow:scroll;line-height:1.6;margin-bottom:1.6em;padding:1em 1.5em;-moz-tab-size:2;-o-tab-size:2;tab-size:2;word-wrap:break-word;white-space:pre-wrap;border-left:3px solid #f36d33}div.code-starter>pre code{border-left:3px solid #fdff44!important;background-image:radial-gradient(rgba(0,150,0,.75),#000 120%);color:#fff;font:.9rem Inconsolata,monospace}div.code-starter>pre code::after{content:"\a$_"}</style>
<script src="https://kit.fontawesome.com/7efc4bcee2.js" crossOrigin="anonymous"></script>
<script>
    let stateCheck = setInterval(function(){
      if (document.readyState === 'complete') {
        clearInterval(stateCheck);
        let s1 = document.getElementById('start');
        // console.log('doc is ready', s1);
        if (s1) {
           s1.setAttribute('tabindex', '-1');
           s1.focus(); 
           s1.scrollIntoView({behavior: 'smooth'}); 
           setTimeout(function(){s1.blur()}, 500);
           // console.log('focus set');
        }
      }
    }, 200);
    </script>
</head><body class="lesson"><div class="main-content lesson bg-gray-200 text-black p-1 pl-3 font-serif"><div class="md-inner">
<div id="start" class="section">&nbsp;</div><p class="new">You can actually remove the outliers by uncommenting the last line.</p><h2 id="robust-scaling">Robust Scaling</h2><p class="new">The mean is highly sensitive to outliers. Sklearn's <code>RobustScaler</code> using 
IQR (interquartile range) to keep all values between the 25th and 75 quartile. 
It subtracts the column's median and divides by the interquartile range.</p><p class="new">This <em>scales</em> the data using</p><img alt="math?math=%5CLarge%20x%3D%5Cdfrac%7Bx_i%20-%20Q_2(x)%7D%7BQ_3(x)%20-%20Q_1(x)%7D" class=" formula-block" src="https://render.githubusercontent.com/render/math?math=%5CLarge%20x%3D%5Cdfrac%7Bx_i%20-%20Q_2(x)%7D%7BQ_3(x)%20-%20Q_1(x)%7D"/><p class="new">RobustScaler can be used when you want to reduce the effects of having many outliers. 
However, removing unimportant outliers (see above) should also be done.</p><h2 id="confused--">Confused ðŸ¤·ðŸ¤” ?</h2><p class="new">It's not necessarily easy to know which technique to use. The best strategy
is to evaluate models with the data prepared using different techniques. 
Sometimes, it's a combination of a few of the methods. </p><p class="new">There are a few guidelines to help make a first approximation:</p><ul><li>if the distribution of the quantity is normal, then it should be standardized,</li><li>if the distribution is not normal, the data should be normalized. This applies if the range of quantity values is large (10s, 100s, etc.) or small (0.01, 0.0001).</li></ul><ul><li><strong><code>Min-Max Scaler</code></strong>
<ul><li>Re-scales to predetermined range [0â€“1]</li><li>Typical neural network algorithm require data that on a 0-1 scale.</li><li>Doesnâ€™t change distributionâ€™s center (doesnâ€™t correct skewness)</li><li>The distribution of the feature (or any transformations of the feature ) isnâ€™t Gaussian</li><li>Feature falls within a bounded interval (sensitive to outliers)</li></ul></li><li><strong><code>Standard Scaler</code></strong>
<ul><li>Shifts distributionâ€™s mean to 0 and unit variance</li><li>No predetermined range</li><li>Best to use on data that is approximately normally distributed clustering, PCA (those that rely on using variance)</li></ul></li><li><strong><code>Robust Scaler</code></strong>
<ul><li>0 mean and unit variance</li><li>Use of quartile ranges makes this less sensitive to (a few) outliers</li><li>No predetermined range</li></ul></li></ul><h2 id="custom-cleaning">Custom Cleaning</h2><p class="new">Sometimes, it's necessary to provide cleaning beyond what a library has to
 offer.  Sklearn's <code>FunctionTransformer</code> can be used in these situations. For example, 
the dataset has an 'sid' field which is actually a string representing the
 birth year of the person on board the Titanic.  If you wanted to do 'math' on 
that field, a <code>FunctionTransformer</code> could be used to convert that string into a number:</p><p class="new">The following code (you should implement it) demonstrates how to convert a
 string field (<code>sid</code>) to an integer.  Once that is done, the field can be
 used like any valid numeric attribute:</p><blockquote><p class="new"><strong><em>Coder's Log</em></strong> You may see references to integer (int for short) or
 floating point (float for short).  These are different ways to represent
 numbers.  A floating point is a number with a decimal point (e.g 123.45) 
and an integer has no decimal place (whole numbers). Floating point numbers 
have more precision. </p></blockquote><pre><code>import numpy as np
from sklearn.preprocessing import FunctionTransformer

def string_to_float(v):
  # v is an array of values
  return v.astype(np.float)

def string_to_int(v):
  # v is an array of values
  return v.astype(np.int)

def clean_sid(df):

  # first clean any missing values
  mode = df['sid'].mode()[0]
  df['sid'].fillna(mode, inplace=True)
  
  # because 'sid' is pandas StringArray, reshape(-1,1) won't work
  # print(type(df['sid'].values))

  # either of these will work
  values = df['sid'].values
  # OR
  # attribute = ['sid']
  # values = df[attribute]

  transformer = FunctionTransformer(string_to_int)
  df['sid'] = transformer.fit_transform(values)
  return df</code></pre><p class="new">The following code cell demonstrates the custom cleaning: </p></div></div></body></html>